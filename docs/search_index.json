[
<<<<<<< Updated upstream
["index.html", "Pathways CBW workshop Pathway and Network Analysis of -Omics Data (July 2020) Meet your Faculty", " Pathways CBW workshop Gary Bader, Veronique Voisin, Ruth Isserlin, Robin Haw, Michael Hoffman last modified 2020-07-21 Pathway and Network Analysis of -Omics Data (July 2020) The CBW has developed a 2.5 day course covering the bioinformatics concepts and tools available for interpreting a gene list using pathway and network information. The workshop focuses on the principles and concepts required for analyzing and conducting pathway and network analysis on a gene list from any organism, although focus will be on human and model eukaryotic organisms. Meet your Faculty Gary Bader Principal Investigator, University of Toronto Dr. Bader develops biological network analysis and pathway information resources. He created the Biomolecular Interation Network Database ( BIND ) while working on his PhD and currently helps lead development of the free Cytoscape network visualization and analysis software Cytoscape. Robin Haw Manager of Reactome Outreach and Scientific Associate, OICR Robin is a microbiologist with experience in bioinformatics, curation and outreach. Dr. Haw has a PhD in genetics and was a senior curator at Biomolecular Interaction Network Database (BIND) and managing curator at Science Signaling’s Signal Transduction Knowledge Environment (STKE). He has been responsible for coordinating outreach, Reactome presentations and training at workshops and conferences. Michael Hoffman Scientist, Princess Margaret Cancer Centre Assistant Professor, Departments of Medical Biophysics and Computer Science, University of Toronto Faculty Affiliate, Vector Institute Michael Hoffman creates predictive computational models to understand interactions between genome, epigenome, and phenotype in human cancers. He implemented the genome annotation method Segway, which simplifies interpretation of large multivariate genomic datasets, and was a linchpin of the NIH ENCODE Project analysis. He was named a CIHR New Investigator and has received several awards for his academic work, including the NIH K99/R00 Pathway to Independence Award, and the Ontario Early Researcher Award. Veronique Voisin Research Associate, Donnelly Centre for Cellular and Biomolecular Research, University of Toronto Veronique is currently a bioinformatician applying pathway and networks analysis to high throughput genomics data for OICR cancer stem cell program. Previously, she worked on characterizing the gene signatures of different types of leukemias using a murine model Ruth Isserlin Research data analyst, Donnelly Centre for Cellular and Bimolecular Research, University of Toronto Bioinformatician and data analyst in the Bader lab applying pathway and data analysis to varied data types. Developed Enrichment Map App for Cytoscape, an app to visually translate functional enrichment results from popular enrichment tools like GSEA to networks. Further developed the Enrichment Map Pipeline including development of additional Apps to help summarize and analyze resulting Enrichment Maps, including PostAnalysis, WordCloud, and AutoAnnotate App. Francis Ouellette CBW Scientific Coordinator Francis was one of the co-founders of the CBW in 1998. His teams were involved in the development of high throughput sequence analysis methods, as well as the development of platforms to integrate data from various open databases. Francis continues to be interested in computational biology and genomics, and the integration of all data types to help our understanding of biology. Rachade Hmamouchi Program Manager, Canadian Bioinformatics Workshops (CBW) &amp; McGill initiative in Computational Medicine (MiCM) Rachade is a bioinformatician by training, and over the span of her career, she has worked at universities, biotech, and industry fields. She is leading the organisation of the workshops at the CBW and at the MiCM. Thank you for attending the Pathway and Network Analysis of Omics Data workshop! Help us make this workshop better by filling out our survey. This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License. This means that you are able to copy, share and modify the work, as long as the result is distributed under the same license. Icons are from the “Very Basic. Android L Lollipop” set by Ivan Boyko licensed under CC BY 3.0 and Icons8. "],
["welcome.html", "Welcome Class Materials Workshop Schedule Pre-Workshop Materials and Laptop Setup Instructions Pre-workshop Tutorials", " Welcome Welcome to Pathways and Network Analysis of -Omics Data 2020. Class Materials You can download the printed course manual here. Workshop Schedule Pre-Workshop Materials and Laptop Setup Instructions Laptop Setup Instructions A Check list to setup your laptop can be found here Install these tools on your laptop before coming to the workshop: Basic programs A robust text editor: For Windows/PC - notepad++ For Linux - gEdit For Mac – TextWrangler A file decompression tool. For Windows/PC – 7zip. For Linux – gzip. For Mac – already there. A robust internet browser such as: Firefox Safari Chrome A PDF Viewer Adobe Acrobat or equivalent Java 11 Installation We will be using Cytoscape and GSEA both of which require Java 11. Before proceeding, check to see if you already have Java 11 installed: Go to https://www.java.com/verify/ - OR Open a terminal window and run the following command: java -version If you do not have Java installed or you have an older version of Java installed please proceed with the following steps: Download and install Java 11: Go to https://www.oracle.com/java/technologies/javase-jdk11-downloads.html create a free Oracle account - Top right hand corner --&gt; View Accounts --&gt; Create Account Download the java installer that corresponds to your platform (MAC, Windows or Linux) Open the installer and follow the steps An &quot;Install Succeeded&quot; should appear at the end of the installer dialog box You can check that you correctly installed java by typing java -version in terminal window Cytoscape Installation Please install the latest version of Cytoscape 3.8.0 as well as a group of Cytoscape Apps that we will be using for different parts of the course. Install Cytoscape 3.8.0: Go to: https://cytoscape.org/download-platforms.html Choose the version corresponding to your operating system (OS, Windows or UNIX) Follow instructions to install cytoscape Verify that Cytoscape has been installed correctly by launching the newly installed application Contact your system administrator if you have trouble with Java installation WInstall the following Cytoscape Apps - Apps are installed from within Cytoscape. In order to install Apps launch Cytoscape From the menu bar, select ‘Apps’, then ‘App Manager’. Within 'all apps', search for the following and install: EnrichmentMap 3.3.0 EnrichmentMap Pipeline Collection 1.0.0 (it will install ClusterMaker2, WordCloud and AutoAnnotate) GeneMANIA 3.5.2 IRegulon 1.3 ReactomeFIPlugin 7.2.3 - http://apps.cytoscape.org/apps/reactomefiplugin stringApp 1.5.1 yFiles Layout Algorithms 1.1 Install the data set within GeneMANIA app. This requires time and a good network connection to download completely (~15mins) From the menu bar, select ‘Apps’, hover over ‘GeneMANIA’, then select ‘Choose Another Data Set’. From the list of available data sets, select the most recent and under ‘Include only these networks:’ select ‘all’. Click on ‘Download’. An ‘Install Data’ window will pop-up. Select H.Sapiens Human (2589 MB). Click on ‘Install’. GSEA Installation Please install the latest version of GSEA (4.0.3) Download GSEA Go to the GSEA page Register (using an institutional email address) Login Locate the Download page and download the version corresponding to your system MAC users: download GSEA_4.0.3.app.zip Window users: download GSEA_Win_4.0.3-installer.exe Unix users: download GSEA_Linux_4.0.3.zip Launch GSEA to test it. Download GSEA for command line : this is necessary for all platform users to run GSEA from a script (integrated workflow on day 3) Download GSEA_4.0.3.zip (and keep it for later use during the workshop) Pre-workshop Tutorials It is in your best interest to complete these before the workshop. Cytoscape Preparation tutorials Go to : https://github.com/cytoscape/cytoscape-tutorials/wiki and follow : Tour of Cytoscape Basic Data Visualization Pre-workshop Readings and Lectures Video Module 1 - Introduction to Pathway and Network Analysis by Gary Bader Video Module 5 - Gene Function Prediction (GeneMania) by Quaid Morris Pathway enrichment analysis and visualization of omics data using g:Profiler, GSEA, Cytoscape and EnrichmentMap Reimand J, Isserlin R, Voisin V, Kucera M, Tannus-Lopes C, Rostamianfar A, Wadi L, Meyer M, Wong J, Xu C, Merico D, Bader GD Nat Protoc. 2019 Feb;14(2):482-517 - Available here as well Additional tutorials iRegulon: from a gene list to a gene regulatory network using large motif and track collectionsJanky R, Verfaillie A, Imrichová H, Van de Sande B, Standaert L, Christiaens V, Hulselmans G, Herten K, Naval Sanchez M, Potier D, Svetlichnyy D, Kalender Atak Z, Fiers M, Marine JC, Aerts S PLoS Comput Biol. 2014 Jul 24;10(7) The GeneMANIA prediction server: biological network integration for gene prioritization and predicting gene function Warde-Farley D, Donaldson SL, Comes O, Zuberi K, Badrawi R, Chao P, Franz M, Grouios C, Kazi F, Lopes CT, Maitland A, Mostafavi S, Montojo J, Shao Q, Wright G, Bader GD, Morris Q Nucleic Acids Res 2010 Jul 1;38 Suppl:W214-20 - Available here as well GeneMANIA update 2018 Franz M, Rodriguez H, Lopes C, Zuberi K, Montojo J, Bader GD, Morris Q Nucleic Acids Res. 2018 Jun 15 - Available here as well How to visually interpret biological data using networks Merico D, Gfeller D, Bader GD Nature Biotechnology 2009 Oct 27, 921-924 - Available here as well g:Profiler--a web-based toolset for functional profiling of gene lists from large-scale experiments. Reimand J, Kull M, Peterson H, Hansen J, Vilo J Nucleic Acids Res. 2007 Jul;35 g:Profiler: a web server for functional enrichment analysis and conversions of gene lists (2019 update) Raudvere U, Kolberg L, Kuzmin I, Arak T, Adler P, Peterson H, Vilo J Nucleic Acids Res. 2019 May 8 Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles Subramanian A, Tamayo P, Mootha VK, Mukherjee S, Ebert BL, Gillette MA, Paulovich A, Pomeroy SL, Golub TR, Lander ES, Mesirov JP Proc Natl Acad Sci U S A. 2005 Oct 25;102(43) Expression data analysis with Reactome Jupe S, Fabregat A, Hermjakob H Curr Protoc Bioinformatics. 2015 Mar 9;49:8.20.1-9 Interacting with Cytoscape using CyRest and command lines (for advanced users): https://github.com/cytoscape/cytoscape-automation/blob/master/for-scripters/R/advanced-cancer-networks-and-data-rcy3.Rmd "],
["intro.html", "Module 1 - Introduction to Pathway and Network Analysis (Gary Bader)", " Module 1 - Introduction to Pathway and Network Analysis (Gary Bader) "],
["module-2-finding-over-represented-pathways-veronique-voisin.html", "Module 2: Finding Over-represented Pathways (Veronique Voisin)", " Module 2: Finding Over-represented Pathways (Veronique Voisin) Veronique Voisin and Ruth Isserlin Lecture Introduction to practical lab Lab practical part 1 (g:Profiler) Lab practical part 2 (GSEA) "],
["gprofiler-lab.html", "Module 2 lab - g:Profiler Introduction Goal of the exercise 1 Data Exercise 1 - run g:Profiler Exercise 2: Load and use a custom .gmt file and run the query Optional steps", " Module 2 lab - g:Profiler This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License. This means that you are able to copy, share and modify the work, as long as the result is distributed under the same license. Introduction Performing Over-representation analysis (ORA) with g:Profiler. The practical lab contains 2 exercises. The first exercises uses g:Profiler to perform gene-set enrichment analysis. Goal of the exercise 1 Learn how to run g:GOSt Functional profiling from the g:Profiler website and explore the results. Data g:Profiler requires a list of genes, one per line, in a text file or spreadsheet, ready to copy and paste into a web page: for this, we use genes with frequent somatic SNVs identified in TCGA exome sequencing data of 3,200 tumors of 12 types6. The MuSiC cancer driver mutation detection software was used to find 127 cancer driver genes that displayed higher than expected mutation frequencies in cancer samples (Supplementary Table 1, which is derived from column B of Supplementary Table 4 in Kandoth C. et al. ) (https://www.nature.com/articles/nature12634). Genes are ranked in decreasing order of significance (FDR Q value) and mutation frequency (not shown). Exercise 1 - run g:Profiler For this exercise, our goal is to copy and paste the list of genes into g:Profiler, adjust some parameters (e.g selecting the pathway databases), run the query and explore the results. g:Profiler performs a gene-set enrichment analysis using a hypergeometric test (Fisher’s exact test) with the option to consider the ranking of the genes in the calculation of the enrichment significance (minimum hypergeometric test). The Gene Ontology Biological Process and Reactome are going to be selected as pathway databases. The results are displayed as a table or downloadable as an EnrichmentMap type output (GEM). Before starting this exercise, download the required files: Right click on link below and select &quot;Save Link As...&quot;. Place it in the corresponding module directory of your CBW work directory. Supplementary_Tabe1_Cancer_drivers.txt We recommend saving all these files in a personal project data folder before starting. We also recommend creating an additional result data folder to save the files generated while performing the protocol. Step 1 - Launch g:Profiler. Open the g:Profiler website at g:Profiler in your web browser. Step 2 - input query Paste the gene list (Supplementary_Table1_Cancer_drivers.txt) into the Query field in top-left corner of the screen. The gene list can be space-separated or one per line. The organism for the analysis, Homo sapiens, is selected by default. The input list can contain a mix of gene and protein IDs, symbols and accession numbers. Duplicated and unrecognized IDs will be removed automatically, and ambiguous symbols can be refined in an interactive dialogue after submitting the query. open the file in a simple text editor such as Notepad or Textedit to copy the list of genes. Step 3 - Adjust parameters. 3a. Click on the Advanced options tab (black rectangle) to expand it. Set Significance threshold to &quot;Benjamini-Hochberg FDR&quot; User threshold - select 0.05 if you want g:Profiler to return only pathways that are significant (FDR &lt; 0.05). if g:Profiler does not return any results increase the threshold (0.1, then 1) to check that g:Profiler is running successfully but there are simply no significant results for your query. 3b. Click on the Data sources tab (black rectangle) to expand it. UnSelect the following gene-set databases by clicking the &quot;clear all&quot; button. * In the Gene Ontology category, check GO Biological Process and No electronic GO annotations. No electronic GO annotations option will discard less reliable GO annotations (IEAs) that are not manually reviewed. if g:Profiler does not return any results uncheck the No electronic GO annotation option to expand annotations used in the test. In the biological pathways category, check Reactome. Step 4 - Run query Click on the Run query button to run g:Profiler. Scroll down page to see results. If after clicking on Run query button the analysis completes but there is the following message above results file - Select the Ensembl ID with the most GO annotations (all). For each ambiguous gene select its correct mapping. Ambiguous mapping is often caused by multiple ensembl ids for a given gene and are easy to resolve as a user. Rerun query. Step 5 - Explore the results. Step5a: After the query has run, the results are displayed at the bottom of the page, below the input parameters. By default, the &quot;Results&quot; tab is selected. A global graph displays gene-sets that passed the significance threshold of 0.05 for the 2 gene-set databases that we have selected GO Biological Process &quot;GO:BP&quot; and Reactome &quot;REAC&quot;. Numbers in parentheses are indicating the number of gene-sets that passed the threshold. Step5b: Click on &quot;Detailed Results&quot; to view the results in more depth. Two tables are displayed, one for each of the data sources selected. (If more than 2 data sources are selected there will be additional tables for each datasource) Each row of the table contains: Term name - gene-set name Term ID - gene-est identifier Padj - FDR value -log10(Padj) - enrichment score calculated using the formula -log10(padj) variable number of gene columns (One for each gene in the query set) - If the gene is present in the current gene-set its cell is colored. For any data source besides GO the cell is colored black if the gene is found in the gene-set. For the GO data source cells are colored according to the annotation evidence code. Expand the legend tab for detailed coloring mapping of GO evidence codes. The first table displays the gene-sets significantly enriched at FDR 0.05 for the GO:BP database. The second table displays the results corresponding to the Reactome database. Step 6: Expand the stats tab Expand the stats tab by clicking on the double arrow located at the right of the tab. It displays the gene set size (T), the size of our gene list (Q) , the number of genes that overlap between our gene list and the tested gene-set (TnQ) as well as the number of genes in the background (U). Above the GO:BP result table, locate the slide bar that enables to select for the minimum and maximum number of genes in the tested gene-sets (Term size). Change the maximum Term size from 10000 to 1000 and observe the results in the detailed stats panel: Without filtering term size, the top terms were GO terms containing that could contain 4000 or 5000 genes and that were located high in the GO hierarchy (parent term). With filtering the maximum term size to 1000, the top list contains pathways of larger interpretative values. However, please note that the adjusted pvalues was calculated using all gene-sets without size filtering. Step 7: Save the results 7a. In the Detailed Results panel, select &quot;GEM&quot; . It will save the results in a text file in the &quot;Generic Enrichment Map&quot; format that we will use to visualize using Cytoscape. select max term size to 10000 ( = no filtering by gene-set size) and click on the GEM button. A file is downloaded on your computer. select max term size to 1000 ( = filter by gene-set size) and click on the GEM button. A file is downloaded on your computer. 7b: Open the file that you saved using the geneset threshold of 1000 using Microsoft Office Excel or in an equivalent software. Observe the results included in this file: Name of each gene-set Description of each gene-set significance of the overlap (pvalue) significance of the overlap (adjusted pvalue/qvalue) Phenotype Genes included in each gene-set Which term has the best corrected p-value? Which genes in our list are included in this term? Observe that same genes can be present in several lines (pathways are related when they contain a lof of genes in common). The table is formatted for the input into Cytoscape EnrichmentMap. It is called the generic format. The p-value and FDR columns contain identical values because g:Profiler directly outputs the FDR (= corrected p-value) meaning that the p-value column is already the FDR. Phenotype 1 means that each pathway will be represented by red nodes on the enrichment map (presented during next module). The term regulation of transferase activity is the most significant gene-set (=the lowest FDR value). Many gene-sets from the top of this list are related to each other and have genes in common. Step 8 8a. Optional but recommended: Download the pathway database files. * Go to the top of the page and expand the &quot;Data sources&quot; tab. Click on the 'combined name.gmt' link located at bottom of this tab. It will download a zipped folder named combined name.gmt containing a pathway database gmt file with all the available sources. 8b:(Optional) concatenate the GO:BP and Reactome gmt files: If you want to create a smaller gmt file that doesn't contain all of the gprofiler datasources you can instead download name.gmt.zip that contains each datasource as its own gmt file. You will need to concatenate the sources you require into one gmt file to use for later. Option 1: manually if you are not familiar with unix commands open a text editor such a Notepad or equivalent open hsapiens.GO:BP.name.gmt using the text editor open gmt hsapiens.REAC.name.gmt using the text editor copy-paste all the rows from REAC file together with all the rows in GO:BP file and save it as hsapiens.pathways.name.gmt . Option 2: using the cat command if you are familiar with unix commands open your terminal window cd to the unzipped gprofiler_hsapiens.name folder type the following command: cat hsapiens.GO:BP.name.gmt hsapiens.REAC.name.gmt &gt; hsapiens.pathways.name.gmt you will be using this optional hsapiens.pathways.name.gmt file in Cytoscape EnrichmentMap. Exercise 2: Load and use a custom .gmt file and run the query For this exercise, our goal is to copy and paste the list of genes into g:Profiler, upload a custom gmt file, adjust some parameters (e.g selecting the pathway databases), run the query and explore the results. Uploading a custom gmt file enables us to use alternate pathway data sources not available in g:Profiler. We are going to use a gmt file that contains a database of pathway gene sets used for pathway enrichment analysis in the standard GMT format downloaded from http://baderlab.org/GeneSets and updated monthly. This file contains pathways from eight data sources: GO, Reactome, Panther, NetPath, NCI, MSigDB curated gene sets (C2 collection, excluding Reactome and KEGG), MSigDB Hallmark (H collection) and HumanCyc. A GMT file is a text file in which each line represents a gene set for a single pathway. Each line includes a pathway ID, a name and the list of associated genes in a tab-separated format. This file has been filtered to exlclude gene-sets that contained more than 250 genes as these gene-sets are associated with more general terms. Before starting this exercise, download the required files: Right click on link below and select &quot;Save Link As...&quot;. Place it in the corresponding module directory of your CBW work directory. Supplementary_Table1_Cancer_drivers.txt. Baderlab_genesets.gmt. We recommend saving all these files in a personal project data folder before starting. We also recommend creating an additional result data folder to save the files generated while performing the protocol. STEPS: Repeat step 1 to 3a from Exercise 1 (go back to exercise 1 to get detailed instructions) Briefly: Step 1: Open g:profiler Step 2a : Copy and paste the gene list in the Query field Step 2b: Click on the Advanced options tab (black rectangle) to expand it. Set Significance threshold to &quot;Benjamini-Hochberg FDR&quot;. Step 3a: Click on the Data sources tab (black rectangle) to expand it. Unselect all choices by clicking the &quot;clear all&quot; button. Step 4: Click on the Custom GMT tab (black rectangle) to expand it. Drag in the box the Baderlab gmt file Baderlab_genesets.gmt. Once uploaded successfully, the name of the file is displayed in the &quot;File name used&quot; box. Step 5: Click on Run query . Step 6: Explore the detailed results Step 7: Save the file as GEM Optional steps Please follow these optional steps if time permits and/or to explore more g:Profiler parameters. Here below are 3 optional steps that cover several options offered by g:Profiler: test different data sources, take the order of the gene list into account, use different types of multiple hypothesis correction methods. Use the same gene list as used in exercise 1 and modify paramters listed above. Observe the results. Optional 1: If time permits, play with input parameters, e.g. add TRANSFAC and miRTarBase databases, rerun the query and explore the new results. Transfac putative transcription factor binding sites (TFBSs) from TRANSFAC database are retrieved into g:GOSt through a special prediction pipeline. First, TFBSs are found by matching TRANSFAC position specific matrices using the program Match on range +/-1kb from TSS as provided by APPRIS (Annotating principal splice isoforms) via Ensembl biomart. For genes with multiple primary TSS annotations we selected one with most TF matches. The matching range for C. elegans, D. melanogaster and S. cerevisiae is 1kb upstream from ATG (translation start site). A cut-off value to minimize the number of false positive matches (provided by TRANSFAC) is then applied to remove spurious motifs. Remaining matches are split into two inclusive groups based on the amount of matches, i.e TFBSs that have at least 1 match are classified as match class 0 and TFBSs that have at least 2 matches per gene are classified as match class 1. mirTarBase is a database that holds experimentally validated information about genes that are targetted by miRNAs. We include all the organisms that are covered by mirTarBase. Option 2: Re-run the g:Profiler using the ordered query checked. This will run the minimum hypergeometric test. g:Profiler then performs incremental enrichment analysis with increasingly larger numbers of genes starting from the top of the list. When this option is checked, it assumes that the genes were preordered by significance with the most significant gene at the top of the list. Compare the results between &quot;ordered&quot; and non ordered query. for this practical lab, the genes were ordered by the number of mutations found in these genes for all samples. For example, TP53, a highly mutated genes is listed at the top. Option 3 : Re-run g:Profiler and select g:SCS or Bonferonni as method to correct for multiple hypothesis testing. Do you get any significant results? you can get detailed information about these methods at https://biit.cs.ut.ee/gprofiler/page/docs in the section Significance threshold. Instead of using the g:Profiler website g:profiler can be run directly from R or python see g:Profiler document for more info at https://biit.cs.ut.ee/gprofiler/page/r "],
["gsea-lab.html", "Module 2 lab - GSEA Introduction Goal of the exercise Data Background Additional information", " Module 2 lab - GSEA Presenter: Ruth Isserlin Introduction This practical lab contains one exercise. It uses GSEA to perform a gene-set enrichment analysis. Goal of the exercise Learn how to run GSEA and explore the results. Data The data used in this exercise is gene expression (transcriptomics) obtained from high-throughput RNA sequencing of Ovarian Serous Cystadenocarcinoma samples. This cohort was previously stratified into four distinct expression subtypes PMID:21720365 and a subset of the immunoreactive and mesenchymal subtypes are compared to demonstrate the GSEA workflow. How was the data processed? Gene expression from the TCGA Ovarian serous cystadenocarcinoma RNASeq V2 cohort was downloaded on 2015-05-22 from cBioPortal for Cancer Genomics. Differential expression for all genes between the mesenchymal and immunoreactive groups was estimated using edgeR. The R code used to generate the data and the rank file used in GSEA is included at the bottom of the document in the Additional information section. Background The goal of this lab is to: upload the 2 required files into GSEA, adjust relevant parameters, run GSEA, open and explore the gene-set enrichment results. The 2 required files are: a rank file (.rnk) a pathway definition file (.gmt). Rank File To generate a rank file (.rnk), a score (-log10(pvalue) * sign(logFC)) was calculated from the edgeR differential expression results. A gene that is significantly differentially expressed(i.e associated with a very small pvalue, close to 0) will be assigned a high score. The sign of the logFC indicates if the gene has an expression which is higher in mesenchymal (logFC &gt; 0, the score will have a + sign) or lower in mesenchymal (logFC &lt; 0, the score will have a - sign). It is used to rank the genes from top up-regulated to top down-regulated (all genes have to be included). The rank file is going to be provided for the lab, you don't need to generate it. How to generate a rank file. Calculation of the score Generation of the rank file select the gene names and score columns and save the file as tab delimited with the extension .rnk Pathway defintion file The second file that is needed for GSEA is the pathway database, a file with the .gmt extension. The pathway database (.gmt) used for the GSEA analysis was downloaded from http://baderlab.org/GeneSets. This file contains gene-sets obtained from MsigDB-c2, NCI, Biocarta, IOB, Netpath, HumanCyc, Reactome and the Gene Ontology (GO) databases. You don't need to perform this step for the exercise, the .gmt file will be given to you. Go to: http://download.baderlab.org/EM_Genesets/ click on current_release/ Click on Human/ Click on symbol/ save the Human_GOBP_AllPathways_no_GO_Iiea...gmt file on your computer The .gmt is a tab delimited text file which contains one gene-set per row. For each gene-set (row), the first 2 columns contain the name and the description of the gene-set and the remaining columns contain the list of genes included in the gene-set. It is possible to create a custom gene-set using Excel or R. GSEA performs a gene-set enrichment analysis using a modified Kolmogorov-Smirnov statistic. The output result consists of summary tables displaying enrichment statistics for each gene-set (pathway) that has been tested. Start the exercise Before starting this exercise, download the 2 required files: Right click on link below and select &quot;Save Link As...&quot;. Place it in the corresponding module directory of your CBW work directory. Human_GOBP_AllPathways_no_GO_iea_July_01_2020_symbol.gmt MesenchymalvsImmunoreactive_edger_ranks.rnk Step1. Launch GSEA by double clicking on the installed program icon. If GSEA won't launch on MacOS. Follow instructions specified on download page: * If you see this error message: Open Settings -&gt; Security &amp; Privacy Click on &quot;Open Anyways&quot; Step 2. Load Data 2a. Locate the ‘Load data’ icon at the upper left corner of the window and click on it. 2b. In the central panel, select ‘Method 1’ and ‘Browse for files’. A new window pops up. 2c. Browse your computer to locate the 2 files : Human_GOBP_AllPathways_no_GO_iea_July_01_2020_symbol.gmt and MesenchymalvsImmunoreactive_edger_ranks.rnk. 2d. Click on Choose. A message pops us when the files are loaded successfully. 2e. Click on OK. Alternatively, you can choose Method 3 to drag and drop files here; you need to click on the Load these files! button in this case. Step3. Adjust parameters 3a. Under the Tools menu select GseaPreRanked. 3b. Run GSEA on a Pre-Ranked gene list tab will appear. Specify the following parameters: 3c. Gene sets database - click on the radio button (…) located at the right of the blank field. Wait 5-10sec for the gene-set selection window to appear. Use the right arrow in the top field to see the Gene matrix (local gmx/gmt) tab. Click to highlight Human_GOBP_AllPathways_no_GO_iea_July_01_2020_symbol.gmt. click on OK at the bottom of the window. Human_GOBP_AllPathways_no_GO_iea_December_24_2016_symbol.gmt is now visible in the field corresponding to Gene sets database. 3d. Number of permutations - 100. The number of permutations is the number of times that the gene-sets will be randomized in order to create a null distribution to calculate the FDR. Use 2000 when you do it for your own data outside the workshop. 3e. Ranked list - select by clicking on the arrow and highlighting rank file. 3f. Collapse/Remap to gene symbols - Change to No_collapse. (Our rank file already contains the gene symbols so we don't need GSEA to try and convert probe names to gene symbols) 3g. Click on Show button next to Basic Fields to display extra options. 3h. Analysis name – change default my_analysis to name specific to analysis for example Mesen_vs_Immuno_edgeR. GSEA will use your specified name as part of the name of the results directory it creates. 3i. Max size: exclude larger sets – By default GSEA sets the upper limit to 500. In this protocol, the maximum is set to 200 to decrease some of the larger sets in the results. 3j. Min size: exclude smaller sets – By default GSEA sets the lower limit to 15. In this protocol, the minimum is set to 10 to increase some of the smaller sets in the results. 3k. Save results in this folder – navigate to where you want GSEA to put the results folder. By default GSEA will put the results into the directory gsea_home/output/[date] in your home directory. set Enrichment Statistics to p2 if you want to add more weight on the most top up-regulated and top down-regulated. P2 is a more stringent parameter and it will result in less gene-sets significant under FDR &lt;0.05. Step 4. Run GSEA 4a. Click on Run button located at the bottom right corner of the window. Expand the window size if the run button is not visible 4b. On the panel located on the left side of the GSEA window, the bottom panel called the GSEA report table will show that it has created a process with a message that it is Running. On completion the status message will be updated to Success…. There is no progress bar to indicate to the user how much time is left to complete the process. Depending on the size of your dataset and compute power a GSEA run can take from a few minutes to a few hours. To check on the status of the GSEA run in the bottom left hand corner you can click on the + (red circle in below Figure) to see the updating status. Printouts in the format shuffleGeneSet for GeneSet 5816/5821 nperm: 1000 indicate how many permutations have been done (5816) out of the total that need to be performed (5821). if the permutations have been completed but the status is still running, it means that GSEA is creating the report Java Heap Space error. If GSEA returns an error Java Heap space it means that GSEA has run out of memory. If you are running GSEA from the webstart other than the 4GB option then you will need to download a new version that allows for more memory allocation. The current maximum memory allocation that the GSEA webstart allows for is 4GB. If you are using this version and still receive the java heap error you will need to download the GSEA java jar file and launch it from the command line as described in step 1. Step 5. Examining the results 5a. Click on Success to launch the results in html format in your default web browser. If the GSEA application has been closed, you can still see the results by opening the result folder and clicking on the index file – index.html. (see screenshot below). The first phenotype corresponds to gene-sets enriched in genes up-regulated in the mesenchymal subtype. The second phenotype corresponds to gene-sets enriched in genes up-regulated in the immunological phenotype. When examining the results there are a few things to look for: 5b. Check the number of gene-sets that have been used for the analysis. A small number (a few hundred genesets if using baderlab genesets) could indicate an issue with identifier mapping. 5c. Check the number of sets that have FDR less than 0.25 – in order to determine what thresholds to start with when creating the enrichment map. It is not uncommon to see a thousand gene sets pass the threshold of FDR less than 0.25. FDR less than 0.25 is a very lax threshold and for robust data we can set thresholds of FDR less than 0.05 or lower. 5d. Click on Snapshots to see the trend for the top 20 genesets. For the positive phenotype the top genesets should show a distribution skewed to the left (positive) i.e. genesets have predominance of up-regulated genes. For the negative phenotype the top geneset should be inverted and skewed to the right (negative) i.e. geneset have predominance of down-regulated genes. 5e. Explore the tabular format of the results. Mesenchymal Immunoreactive Link to information about GSEA results Additional information More on GSEA data format More on processing the RNAseq using EdgeR and generate the .rank file More on which .gmt file to download from the Baderlab gene-set file, select current release, Human, symbol, Human_GOBP_AllPathways_no_GO_iea_….gmt More on GSEA : link to the Baderlab wiki page on GSEA "],
=======
["index.html", "Pathways CBW workshop Pathway and Network Analysis of -Omics Data (July 2020) Meet your Faculty", " Pathways CBW workshop Gary Bader, Veronique Voisin, Ruth Isserlin, Robin Haw, Michael Hoffman last modified 2020-07-20 Pathway and Network Analysis of -Omics Data (July 2020) The CBW has developed a 2.5 day course covering the bioinformatics concepts and tools available for interpreting a gene list using pathway and network information. The workshop focuses on the principles and concepts required for analyzing and conducting pathway and network analysis on a gene list from any organism, although focus will be on human and model eukaryotic organisms. Meet your Faculty Gary Bader Principal Investigator, University of Toronto Dr. Bader develops biological network analysis and pathway information resources. He created the Biomolecular Interation Network Database ( BIND ) while working on his PhD and currently helps lead development of the free Cytoscape network visualization and analysis software Cytoscape. Robin Haw Manager of Reactome Outreach and Scientific Associate, OICR Robin is a microbiologist with experience in bioinformatics, curation and outreach. Dr. Haw has a PhD in genetics and was a senior curator at Biomolecular Interaction Network Database (BIND) and managing curator at Science Signaling’s Signal Transduction Knowledge Environment (STKE). He has been responsible for coordinating outreach, Reactome presentations and training at workshops and conferences. Michael Hoffman Scientist, Princess Margaret Cancer Centre Assistant Professor, Departments of Medical Biophysics and Computer Science, University of Toronto Faculty Affiliate, Vector Institute Michael Hoffman creates predictive computational models to understand interactions between genome, epigenome, and phenotype in human cancers. He implemented the genome annotation method Segway, which simplifies interpretation of large multivariate genomic datasets, and was a linchpin of the NIH ENCODE Project analysis. He was named a CIHR New Investigator and has received several awards for his academic work, including the NIH K99/R00 Pathway to Independence Award, and the Ontario Early Researcher Award. Veronique Voisin Research Associate, Donnelly Centre for Cellular and Biomolecular Research, University of Toronto Veronique is currently a bioinformatician applying pathway and networks analysis to high throughput genomics data for OICR cancer stem cell program. Previously, she worked on characterizing the gene signatures of different types of leukemias using a murine model Ruth Isserlin Research data analyst, Donnelly Centre for Cellular and Bimolecular Research, University of Toronto Bioinformatician and data analyst in the Bader lab applying pathway and data analysis to varied data types. Developed Enrichment Map App for Cytoscape, an app to visually translate functional enrichment results from popular enrichment tools like GSEA to networks. Further developed the Enrichment Map Pipeline including development of additional Apps to help summarize and analyze resulting Enrichment Maps, including PostAnalysis, WordCloud, and AutoAnnotate App. Francis Ouellette CBW Scientific Coordinator Francis was one of the co-founders of the CBW in 1998. His teams were involved in the development of high throughput sequence analysis methods, as well as the development of platforms to integrate data from various open databases. Francis continues to be interested in computational biology and genomics, and the integration of all data types to help our understanding of biology. Rachade Hmamouchi Program Manager, Canadian Bioinformatics Workshops (CBW) &amp; McGill initiative in Computational Medicine (MiCM) Rachade is a bioinformatician by training, and over the span of her career, she has worked at universities, biotech, and industry fields. She is leading the organisation of the workshops at the CBW and at the MiCM. Thank you for attending the Pathway and Network Analysis of Omics Data workshop! Help us make this workshop better by filling out our survey. This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License. This means that you are able to copy, share and modify the work, as long as the result is distributed under the same license. Icons are from the “Very Basic. Android L Lollipop” set by Ivan Boyko licensed under CC BY 3.0. "],
["welcome.html", "Welcome Class Materials Workshop Schedule Pre-Workshop Materials and Laptop Setup Instructions Pre-workshop Tutorials", " Welcome Welcome to Pathways and Network Analysis of -Omics Data 2020. Class Materials You can download the printed course manual here. Workshop Schedule Pre-Workshop Materials and Laptop Setup Instructions Laptop Setup Instructions A Check list to setup your laptop can be found here Install these tools on your laptop before coming to the workshop: Basic programs A robust text editor: For Windows/PC - notepad++ For Linux - gEdit For Mac – TextWrangler A file decompression tool. For Windows/PC – 7zip. For Linux – gzip. For Mac – already there. A robust internet browser such as: Firefox Safari Chrome A PDF Viewer Adobe Acrobat or equivalent Java 11 Installation We will be using Cytoscape and GSEA both of which require Java 11. Before proceeding, check to see if you already have Java 11 installed: Go to https://www.java.com/verify/ - OR Open a terminal window and run the following command: java -version If you do not have Java installed or you have an older version of Java installed please proceed with the following steps: Download and install Java 11: Go to https://www.oracle.com/java/technologies/javase-jdk11-downloads.html create a free Oracle account - Top right hand corner --&gt; View Accounts --&gt; Create Account Download the java installer that corresponds to your platform (MAC, Windows or Linux) Open the installer and follow the steps An &quot;Install Succeeded&quot; should appear at the end of the installer dialog box You can check that you correctly installed java by typing java -version in terminal window Cytoscape Installation Please install the latest version of Cytoscape 3.8.0 as well as a group of Cytoscape Apps that we will be using for different parts of the course. Install Cytoscape 3.8.0: Go to: https://cytoscape.org/download-platforms.html Choose the version corresponding to your operating system (OS, Windows or UNIX) Follow instructions to install cytoscape Verify that Cytoscape has been installed correctly by launching the newly installed application Contact your system administrator if you have trouble with Java installation WInstall the following Cytoscape Apps - Apps are installed from within Cytoscape. In order to install Apps launch Cytoscape From the menu bar, select ‘Apps’, then ‘App Manager’. Within 'all apps', search for the following and install: EnrichmentMap 3.3.0 EnrichmentMap Pipeline Collection 1.0.0 (it will install ClusterMaker2, WordCloud and AutoAnnotate) GeneMANIA 3.5.2 IRegulon 1.3 ReactomeFIPlugin 7.2.3 - http://apps.cytoscape.org/apps/reactomefiplugin stringApp 1.5.1 yFiles Layout Algorithms 1.1 Install the data set within GeneMANIA app. This requires time and a good network connection to download completely (~15mins) From the menu bar, select ‘Apps’, hover over ‘GeneMANIA’, then select ‘Choose Another Data Set’. From the list of available data sets, select the most recent and under ‘Include only these networks:’ select ‘all’. Click on ‘Download’. An ‘Install Data’ window will pop-up. Select H.Sapiens Human (2589 MB). Click on ‘Install’. GSEA Installation Please install the latest version of GSEA (4.0.3) Download GSEA Go to the GSEA page Register (using an institutional email address) Login Locate the Download page and download the version corresponding to your system MAC users: download GSEA_4.0.3.app.zip Window users: download GSEA_Win_4.0.3-installer.exe Unix users: download GSEA_Linux_4.0.3.zip Launch GSEA to test it. Download GSEA for command line : this is necessary for all platform users to run GSEA from a script (integrated workflow on day 3) Download GSEA_4.0.3.zip (and keep it for later use during the workshop) Pre-workshop Tutorials It is in your best interest to complete these before the workshop. Cytoscape Preparation tutorials Go to : https://github.com/cytoscape/cytoscape-tutorials/wiki and follow : Tour of Cytoscape Basic Data Visualization Pre-workshop Readings and Lectures Video Module 1 - Introduction to Pathway and Network Analysis by Gary Bader Video Module 5 - Gene Function Prediction (GeneMania) by Quaid Morris Pathway enrichment analysis and visualization of omics data using g:Profiler, GSEA, Cytoscape and EnrichmentMap Reimand J, Isserlin R, Voisin V, Kucera M, Tannus-Lopes C, Rostamianfar A, Wadi L, Meyer M, Wong J, Xu C, Merico D, Bader GD Nat Protoc. 2019 Feb;14(2):482-517 - Available here as well Additional tutorials iRegulon: from a gene list to a gene regulatory network using large motif and track collectionsJanky R, Verfaillie A, Imrichová H, Van de Sande B, Standaert L, Christiaens V, Hulselmans G, Herten K, Naval Sanchez M, Potier D, Svetlichnyy D, Kalender Atak Z, Fiers M, Marine JC, Aerts S PLoS Comput Biol. 2014 Jul 24;10(7) The GeneMANIA prediction server: biological network integration for gene prioritization and predicting gene function Warde-Farley D, Donaldson SL, Comes O, Zuberi K, Badrawi R, Chao P, Franz M, Grouios C, Kazi F, Lopes CT, Maitland A, Mostafavi S, Montojo J, Shao Q, Wright G, Bader GD, Morris Q Nucleic Acids Res 2010 Jul 1;38 Suppl:W214-20 - Available here as well GeneMANIA update 2018 Franz M, Rodriguez H, Lopes C, Zuberi K, Montojo J, Bader GD, Morris Q Nucleic Acids Res. 2018 Jun 15 - Available here as well How to visually interpret biological data using networks Merico D, Gfeller D, Bader GD Nature Biotechnology 2009 Oct 27, 921-924 - Available here as well g:Profiler--a web-based toolset for functional profiling of gene lists from large-scale experiments. Reimand J, Kull M, Peterson H, Hansen J, Vilo J Nucleic Acids Res. 2007 Jul;35 g:Profiler: a web server for functional enrichment analysis and conversions of gene lists (2019 update) Raudvere U, Kolberg L, Kuzmin I, Arak T, Adler P, Peterson H, Vilo J Nucleic Acids Res. 2019 May 8 Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles Subramanian A, Tamayo P, Mootha VK, Mukherjee S, Ebert BL, Gillette MA, Paulovich A, Pomeroy SL, Golub TR, Lander ES, Mesirov JP Proc Natl Acad Sci U S A. 2005 Oct 25;102(43) Expression data analysis with Reactome Jupe S, Fabregat A, Hermjakob H Curr Protoc Bioinformatics. 2015 Mar 9;49:8.20.1-9 Interacting with Cytoscape using CyRest and command lines (for advanced users): https://github.com/cytoscape/cytoscape-automation/blob/master/for-scripters/R/advanced-cancer-networks-and-data-rcy3.Rmd "],
["intro.html", "Module 1 - Introduction to Pathway and Network Analysis (Gary Bader)", " Module 1 - Introduction to Pathway and Network Analysis (Gary Bader) "],
["module-2-finding-over-represented-pathways-veronique-voisin.html", "Module 2: Finding Over-represented Pathways (Veronique Voisin)", " Module 2: Finding Over-represented Pathways (Veronique Voisin) Veronique Voisin and Ruth Isserlin Lecture Introduction to practical lab Lab practical part 1 (g:Profiler) Lab practical part 2 (GSEA) "],
["gprofiler-lab.html", "Module 2 lab - g:Profiler Introduction Goal of the exercise 1 Data Exercise 1 - run g:Profiler Exercise 2: Load and use a custom .gmt file and run the query Optional steps", " Module 2 lab - g:Profiler This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License. This means that you are able to copy, share and modify the work, as long as the result is distributed under the same license. Introduction Performing Over-representation analysis (ORA) with g:Profiler. The practical lab contains 2 exercises. The first exercises uses g:Profiler to perform gene-set enrichment analysis and the second exercises uses enrichr. Goal of the exercise 1 Learn how to run g:GOSt Functional profiling from the g:Profiler website and explore the results. Data g:Profiler requires a list of genes, one per line, in a text file or spreadsheet, ready to copy and paste into a web page: for this, we use genes with frequent somatic SNVs identified in TCGA exome sequencing data of 3,200 tumors of 12 types6. The MuSiC cancer driver mutation detection software was used to find 127 cancer driver genes that displayed higher than expected mutation frequencies in cancer samples (Supplementary Table 1, which is derived from column B of Supplementary Table 4 in Kandoth C. et al. ) (https://www.nature.com/articles/nature12634). Genes are ranked in decreasing order of significance (FDR Q value) and mutation frequency (not shown). Exercise 1 - run g:Profiler For this exercise, our goal is to copy and paste the list of genes into g:Profiler, adjust some parameters (e.g selecting the pathway databases), run the query and explore the results. g:Profiler performs a gene-set enrichment analysis using a hypergeometric test (Fisher’s exact test) with the option to consider the ranking of the genes in the calculation of the enrichment significance (minimum hypergeometric test). The Gene Ontology Biological Process and Reactome are going to be selected as pathway databases. The results are displayed as a table or downloadable as an EnrichmentMap type output (GEM). Before starting this exercise, download the required files: Right click on link below and select &quot;Save Link As...&quot;. Place it in the corresponding module directory of your CBW work directory. Supplementary_Tabe1_Cancer_drivers.txt We recommend saving all these files in a personal project data folder before starting. We also recommend creating an additional result data folder to save the files generated while performing the protocol. Step 1 - Launch g:Profiler. Open the g:Profiler website at g:Profiler in your web browser. Step 2 - input query Paste the gene list (Supplementary_Table1_Cancer_drivers.txt) into the Query field in top-left corner of the screen. The gene list can be space-separated or one per line. The organism for the analysis, Homo sapiens, is selected by default. The input list can contain a mix of gene and protein IDs, symbols and accession numbers. Duplicated and unrecognized IDs will be removed automatically, and ambiguous symbols can be refined in an interactive dialogue after submitting the query. open the file in a simple text editor such as Notepad or Textedit to copy the list of genes. Step 3 - Adjust parameters. 3a. Click on the Advanced options tab (black rectangle) to expand it. Set Significance threshold to &quot;Benjamini-Hochberg FDR&quot; User threshold - select 0.05 if you want g:Profiler to return only pathways that are significant (FDR &lt; 0.05). if g:Profiler does not return any results increase the threshold (0.1, then 1) to check that g:Profiler is running successfully but there are simply no significant results for your query. 3b. Click on the Data sources tab (black rectangle) to expand it. UnSelect the following gene-set databases by clicking the &quot;clear all&quot; button. * In the Gene Ontology category, check GO Biological Process and No electronic GO annotations. No electronic GO annotations option will discard less reliable GO annotations (IEAs) that are not manually reviewed. if g:Profiler does not return any results uncheck the No electronic GO annotation option to expand annotations used in the test. In the biological pathways category, check Reactome. Step 4 - Run query Click on the Run query button to run g:Profiler. Scroll down page to see results. If after clicking on Run query button the analysis completes but there is the following message above results file - Select the Ensembl ID with the most GO annotations (all). For each ambiguous gene select its correct mapping. Ambiguous mapping is often caused by multiple ensembl ids for a given gene and are easy to resolve as a user. Rerun query. Step 5 - Explore the results. Step5a: After the query has run, the results are displayed at the bottom of the page, below the input parameters. By default, the &quot;Results&quot; tab is selected. A global graph displays gene-sets that passed the significance threshold of 0.05 for the 2 gene-set databases that we have selected GO Biological Process &quot;GO:BP&quot; and Reactome &quot;REAC&quot;. Numbers in parentheses are indicating the number of gene-sets that passed the threshold. Step5b: Click on &quot;Detailed Results&quot; to view the results in more depth. Two tables are displayed, one for each of the data sources selected. (If more than 2 data sources are selected there will be additional tables for each datasource) Each row of the table contains: Term name - gene-set name Term ID - gene-est identifier Padj - FDR value -log10(Padj) - enrichment score calculated using the formula -log10(padj) variable number of gene columns (One for each gene in the query set) - If the gene is present in the current gene-set its cell is colored. For any data source besides GO the cell is colored black if the gene is found in the gene-set. For the GO data source cells are colored according to the annotation evidence code. Expand the legend tab for detailed coloring mapping of GO evidence codes. The first table displays the gene-sets significantly enriched at FDR 0.05 for the GO:BP database. The second table displays the results corresponding to the Reactome database. Step 6: Expand the stats tab Expand the stats tab by clicking on the double arrow located at the right of the tab. It displays the gene set size (T), the size of our gene list (Q) , the number of genes that overlap between our gene list and the tested gene-set (TnQ) as well as the number of genes in the background (U). Above the GO:BP result table, locate the slide bar that enables to select for the minimum and maximum number of genes in the tested gene-sets (Term size). Change the maximum Term size from 10000 to 1000 and observe the results in the detailed stats panel: Without filtering term size, the top terms were GO terms containing that could contain 4000 or 5000 genes and that were located high in the GO hierarchy (parent term). With filtering the maximum term size to 1000, the top list contains pathways of larger interpretative values. However, please note that the adjusted pvalues was calculated using all gene-sets without size filtering. Step 7: Save the results 7a. In the Detailed Results panel, select &quot;GEM&quot; . It will save the results in a text file in the &quot;Generic Enrichment Map&quot; format that we will use to visualize using Cytoscape. select max term size to 10000 ( = no filtering by gene-set size) and click on the GEM button. A file is downloaded on your computer. &lt;img src=&quot;./Module2/gprofiler/images/gp13.png&quot; alt=&quot;workflow&quot; width=&quot;75%&quot; /&gt; select max term size to 1000 ( = filter by gene-set size) and click on the GEM button. A file is downloaded on your computer. 7b: Open one file that you saved using Microsoft Office Excel or in an equivalent software. Observe the results included in this file: Name of each gene-set Description of each gene-set significance of the overlap (pvalue) significance of the overlap (adjusted pvalue/qvalue) Phenotype Genes included in each gene-set :question: Question: Which term has the best corrected p-value? Which genes in our list are included in this term? Observe that same genes can be present in several lines (pathways are related when they contain a lof of genes in common). The table is formatted for the input into Cytoscape EnrichmentMap. It is called the generic format. The p-value and FDR columns contain identical values because g:Profiler directly outputs the FDR (= corrected p-value) meaning that the p-value column is already the FDR. Phenotype 1 means that each pathway will be represented by red nodes on the enrichment map (presented during next module). The term positive regulation of activin receptor signaling pathway is the most significant gene-set (=the lowest FDR value). Many gene-sets from the top of this list are related to each other and have genes in common. Step 8 8a. Optional but recommended: Download the pathway database files. * Go to the top of the page and expand the &quot;Data sources&quot; tab. Click on the 'name.gmt' link located at bottom of this tab. It will download a zipped folder named gprofiler_hsapiens.name.zip containing several pathway database gmt files. 8b: concatenate the GO:BP and Reactome gmt files: option 1: manually if you are not familiar with unix commands open a text editor such a Notepad or equivalent open hsapiens.GO:BP.name.gmt using the text editor open gmt hsapiens.REAC.name.gmt using the text editor copy-paste all the rows from REAC file together with all the rows in GO:BP file and save it as hsapiens.pathways.name.gmt . option 2: using the cat command if you are familiar with unix commands open your terminal window cd to the unzipped gprofiler_hsapiens.name folder type the following command: cat hsapiens.GO:BP.name.gmt hsapiens.REAC.name.gmt &gt; hsapiens.pathways.name.gmt you will be using this optional hsapiens.pathways.name.gmt file in Cytoscape EnrichmentMap. Exercise 2: Load and use a custom .gmt file and run the query For this exercise, our goal is to copy and paste the list of genes into g:Profiler, upload a custom gmt file, adjust some parameters (e.g selecting the pathway databases), run the query and explore the results. Uploading a custom gmt file enables us to use alternate pathway data sources not available in g:Profiler. We are going to use a gmt file that contains a database of pathway gene sets used for pathway enrichment analysis in the standard GMT format downloaded from http://baderlab.org/GeneSets and updated monthly. This file contains pathways from eight data sources: GO, Reactome, Panther, NetPath, NCI, MSigDB curated gene sets (C2 collection, excluding Reactome and KEGG), MSigDB Hallmark (H collection) and HumanCyc. A GMT file is a text file in which each line represents a gene set for a single pathway. Each line includes a pathway ID, a name and the list of associated genes in a tab-separated format. This file has been filtered to exlclude gene-sets that contained more than 250 genes as these gene-sets are associated with more general terms. Before starting this exercise, download the required files: Supplementary_Table1_Cancer_drivers.txt. Baderlab_genesets.gmt. We recommend saving all these files in a personal project data folder before starting. We also recommend creating an additional result data folder to save the files generated while performing the protocol. STEPS: Repeat step 1 to 3a from Exercise 1 (go back to exercise 1 to get detailed instructions) Briefly: Step 1: Open g:profiler Step 2a : Copy and paste the gene list in the Query field Step 2b: Click on the Advanced options tab (black rectangle) to expand it. Set Significance threshold to &quot;Benjamini-Hochberg FDR&quot;. Step 3a: Click on the Data sources tab (black rectangle) to expand it. Unselect all choices by clicking the &quot;clear all&quot; button. Step 4: Click on the Custom GMT tab (black rectangle) to expand it. Drag in the box the Baderlab gmt file Baderlab_genesets.gmt. Once uploaded successfully, the name of the file is displayed in the &quot;File name used&quot; box. Step 5: Click on Run query . Step 6: Explore the detailed results Step 7: Save the file as GEM Optional steps Please follow these optional steps if time permits and/or to explore more g:Profiler parameters. Here below are 3 optional steps that cover several options offered by g:Profiler: 1. test different data sources, 1. take the order of the gene list into account, 1. use different types of multiple hypothesis correction methods. Use the same gene list as used in exercise 1 and modify paramters listed above. Observe the results. Optional 1: If time permits, play with input parameters, e.g. add TRANSFAC and miRTarBase databases, rerun the query and explore the new results. Transfac putative transcription factor binding sites (TFBSs) from TRANSFAC database are retrieved into g:GOSt through a special prediction pipeline. First, TFBSs are found by matching TRANSFAC position specific matrices using the program Match on range +/-1kb from TSS as provided by APPRIS (Annotating principal splice isoforms) via Ensembl biomart. For genes with multiple primary TSS annotations we selected one with most TF matches. The matching range for C. elegans, D. melanogaster and S. cerevisiae is 1kb upstream from ATG (translation start site). A cut-off value to minimize the number of false positive matches (provided by TRANSFAC) is then applied to remove spurious motifs. Remaining matches are split into two inclusive groups based on the amount of matches, i.e TFBSs that have at least 1 match are classified as match class 0 and TFBSs that have at least 2 matches per gene are classified as match class 1. mirTarBase is a database that holds experimentally validated information about genes that are targetted by miRNAs. We include all the organisms that are covered by mirTarBase. Option 2: Re-run the g:Profiler using the ordered query checked. This will run the minimum hypergeometric test. g:Profiler then performs incremental enrichment analysis with increasingly larger numbers of genes starting from the top of the list. When this option is checked, it assumes that the genes were preordered by significance with the most significant gene at the top of the list. Compare the results between &quot;ordered&quot; and non ordered query. for this practical lab, the genes were ordered by the number of mutations found in these genes for all samples. For example, TP53, a highly mutated genes is listed at the top. Option 3 : Re-run g:Profiler and select g:SCS or Bonferonni as method to correct for multiple hypothesis testing. Do you get any significant results? you can get detailed information about these methods at https://biit.cs.ut.ee/gprofiler/page/docs in the section Significance threshold. Instead of using the g:Profiler website g:profiler can be run directly from R or python see g:Profiler document for more info at https://biit.cs.ut.ee/gprofiler/page/r "],
["gsea-lab.html", "Module 2 lab - GSEA Introduction Goal of the exercise Data Background Additional information", " Module 2 lab - GSEA by Veronique Voisin Introduction This practical lab contains one exercise. It uses GSEA to perform a gene-set enrichment analysis. Goal of the exercise Learn how to run GSEA and explore the results. Data The data used in this exercise is gene expression (transcriptomics) obtained from high-throughput RNA sequencing of Ovarian Serous Cystadenocarcinoma samples. This cohort was previously stratified into four distinct expression subtypes PMID:21720365 and a subset of the immunoreactive and mesenchymal subtypes are compared to demonstrate the GSEA workflow. How was the data processed? Gene expression from the TCGA Ovarian serous cystadenocarcinoma RNASeq V2 cohort was downloaded on 2015-05-22 from cBioPortal for Cancer Genomics. Differential expression for all genes between the mesenchymal and immunoreactive groups was estimated using edgeR. The R code used to generate the data and the rank file used in GSEA is included at the bottom of the document in the Additional information section. Background The goal of this lab is to: * upload the 2 required files into GSEA, * adjust relevant parameters, * run GSEA, * open and explore the gene-set enrichment results. The 2 required files are: a rank file (.rnk) a pathway definition file (.gmt). Rank File To generate a rank file (.rnk), a score (-log10(pvalue) * sign(logFC)) was calculated from the edgeR differential expression results. A gene that is significantly differentially expressed(i.e associated with a very small pvalue, close to 0) will be assigned a high score. The sign of the logFC indicates if the gene has an expression which is higher in mesenchymal (logFC &gt; 0, the score will have a + sign) or lower in mesenchymal (logFC &lt; 0, the score will have a - sign). It is used to rank the genes from top up-regulated to top down-regulated (all genes have to be included). Tip: how to generate a rank file. The rank file is going to be provided for the lab, you don't need to generate it. Calculation of the score Generation of the rank file: select the gene names and score columns and save the file as tab delimited with the extension .rnk Pathway defintion file The second file that is needed for GSEA is the pathway database, a file with the .gmt extension. The pathway database (.gmt) used for the GSEA analysis was downloaded from http://baderlab.org/GeneSets. This file contains gene-sets obtained from MsigDB-c2, NCI, Biocarta, IOB, Netpath, HumanCyc, Reactome and the Gene Ontology (GO) databases. You don't need to perform this step for the exercise, the .gmt file will be given to you. The .gmt is a tab delimited text file which contains one gene-set per row. For each gene-set (row), the first 2 columns contain the name and the description of the gene-set and the remaining columns contain the list of genes included in the gene-set. It is possible to create a custom gene-set using Excel or R. GSEA performs a gene-set enrichment analysis using a modified Kolmogorov-Smirnov statistic. The output result consists of summary tables displaying enrichment statistics for each gene-set (pathway) that has been tested. Start the exercise Before starting this exercise, download the 2 required files: Right click on link below and select &quot;Save Link As...&quot;. Place it in the corresponding module directory of your CBW work directory. Human_GOBP_AllPathways_no_GO_iea_May_24_2016_symbol.gmt MesenchymalvsImmunoreactive_edger_ranks.rnk Step1. Launch GSEA. Note regarding option 2: GSEA has been updated to version 3.0: if you still have the gsea_2.2 version, download the .jar file named gsea-3.0.jar from the GSEA Broad website (http://software.broadinstitute.org/gsea/downloads.jsp), open a terminal window and run this command: java -Xmx4G -jar gsea-3.0.jar Step 2. Load Data 2a. Locate the ‘Load data’ icon at the upper left corner of the window and click on it. 2b. In the central panel, select ‘Method 1’ and ‘Browse for files’. A new window pops up. 2c. Browse your computer to locate the 2 files : Human_GOBP_AllPathways_no_GO_iea_May_24_2016_symbol.gmt and MesenchymalvsImmunoreactive_edger_ranks.rnk. 2d. Click on Choose. A message pops us when the files are loaded successfully. 2e. Click on OK. Alternatively, you can choose Method 3 to drag and drop files here; you need to click on the Load these files! button in this case. Step3. Adjust parameters 3a. Under the Tools menu select GseaPreRanked. 3b. Run GSEA on a Pre-Ranked gene list tab will appear. Specify the following parameters: 3c. Gene sets database - * click on the radio button (…) located at the right of the blank field. * :clock10: Wait 5-10sec for the gene-set selection window to appear. Use the right arrow in the top field to see the Gene matrix (local gmx/gmt) tab. Click to highlight Human_GOBP_AllPathways_no_GO_iea_May_24_2016_symbol.gmt. click on OK at the bottom of the window. Human_GOBP_AllPathways_no_GO_iea_December_24_2016_symbol.gmt is now visible in the field corresponding to Gene sets database. 3d. Number of permutations - 100. The number of permutations is the number of times that the gene-sets will be randomized in order to create a null distribution to calculate the FDR. Use 2000 when you do it for your own data outside the workshop. 3e. Ranked list - select by clicking on the arrow and highlighting rank file. 3f. Click on Show button next to Basic Fields to display extra options. 3g. Analysis name – change default my_analysis to name specific to analysis for example Mesen_vs_Immuno_edgeR. GSEA will use your specified name as part of the name of the results directory it creates. 3h. Save results in this folder – navigate to where you want GSEA to put the results folder. By default GSEA will put the results into the directory gsea_home/output/[date] in your home directory. 3i. Min size: exclude smaller sets – By default GSEA sets the lower limit to 15. In this protocol, the minimum is set to 10 to increase some of the smaller sets in the results. set Enrichment Statistics to p1 if you want to add more weight on the most top up-regulated and top down-regulated. P1 is a more stringent parameter and it will result in less gene-sets significant under FDR &lt;0.05. Step 4. Run GSEA 4a. Click on Run button located at the bottom right corner of the window. Expand the window size if the run button is not visible 4b. On the panel located on the left side of the GSEA window, the bottom panel called the GSEA report table will show that it has created a process with a message that it is Running. On completion the status message will be updated to Success…. There is no progress bar to indicate to the user how much time is left to complete the process. Depending on the size of your dataset and compute power a GSEA run can take from a few minutes to a few hours. To check on the status of the GSEA run in the bottom left hand corner you can click on the + (red circle in below Figure) to see the updating status. Printouts in the format shuffleGeneSet for GeneSet 5816/5821 nperm: 1000 indicate how many permutations have been done (5816) out of the total that need to be performed (5821). if the permutations have been completed but the status is still running, it means that GSEA is creating the report Java Heap Space error. If GSEA returns an error Java Heap space it means that GSEA has run out of memory. If you are running GSEA from the webstart other than the 4GB option then you will need to download a new version that allows for more memory allocation. The current maximum memory allocation that the GSEA webstart allows for is 4GB. If you are using this version and still receive the java heap error you will need to download the GSEA java jar file and launch it from the command line as described in step 1. Step 5. Examining the results 5a. Click on Success to launch the results in html format in your default web browser. If the GSEA application has been closed, you can still see the results by opening the result folder and clicking on the index file – index.html. (see screenshot below). The first phenotype corresponds to gene-sets enriched in genes up-regulated in the mesenchymal subtype. The second phenotype corresponds to gene-sets enriched in genes up-regulated in the immunological phenotype. When examining the results there are a few things to look for: 5b. Check the number of gene-sets that have been used for the analysis. A small number (a few hundred genesets if using baderlab genesets) could indicate an issue with identifier mapping. 5c. Check the number of sets that have FDR less than 0.25 – in order to determine what thresholds to start with when creating the enrichment map. It is not uncommon to see a thousand gene sets pass the threshold of FDR less than 0.25. FDR less than 0.25 is a very lax threshold and for robust data we can set thresholds of FDR less than 0.05 or lower. 5d. Click on Snapshots to see the trend for the top 20 genesets. For the positive phenotype the top genesets should show a distribution skewed to the left (positive) i.e. genesets have predominance of up-regulated genes. For the negative phenotype the top geneset should be inverted and skewed to the right (negative) i.e. geneset have predominance of down-regulated genes. 5e. Explore the tabular format of the results. Mesenchymal Immunoreactive Link to information about GSEA results Additional information More on GSEA data format More on processing the RNAseq using EdgeR and generate the .rank file More on which .gmt file to download from the Baderlab gene-set file, select current release, Human, symbol, Human_GOBP_AllPathways_no_GO_iea_….gmt More on GSEA : link to the Baderlab wiki page on GSEA "],
>>>>>>> Stashed changes
["module-3-network-visualization-and-analysis-with-cytoscape.html", "Module 3: Network Visualization and Analysis with Cytoscape", " Module 3: Network Visualization and Analysis with Cytoscape Ruth Isserlin Lecture part 1 Lecture part 2 ## Module 3 Lab Ruth Isserlin Lab practical part 1 (g:Profiler) Lab practical part 2 (GSEA) "],
["gprofiler-mod3.html", "Module 3: g:profiler Visualization Goal of the exercise Data EnrichmentMap Description of this exercise Start the exercise Exercise 1a Exercise 1b Exercise 1c", " Module 3: g:profiler Visualization This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License. This means that you are able to copy, share and modify the work, as long as the result is distributed under the same license. By Veronique Voisin, Ruth Isserlin, Gary Bader Goal of the exercise Create an enrichment map and navigate through the network During this exercise, you will learn how to create an enrichment map from gene-set enrichment results. The enrichment results chosen for this exercise are generated using g:Profiler but an enrichment map can be created directly from output from GSEA or BinGo or alternately from any gene-set tool using the generic enrichment results format. Data The data used in this exercise is a list of frequently mutated genes that we used in previous exercise. Pathway enrichment analysis has been run using g:Profiler and the results have been downloaded as a GEM format. EnrichmentMap A circle (node) is a gene-set (pathway) enriched in genes that we used as input in g:Profiler (frequently mutated genes). edges (lines) represent genes in common between 2 pathways (nodes). A cluster of nodes represent overlapping and related pathways and may represent a common biological process. Clicking on a node will display the genes included in each pathway. Description of this exercise We run and saved g:Profiler results using different parameters. An enrichment map represents the result of enrichment analysis as a network where significantly enriched gene-sets that share a lot of genes in common will form identifiable clusters. The visualization of the results as these biological themes will ease the interpretation of the results. The goal of this exercise is to learn how to: 1. upload g:Profiler results into Cytoscape EnrichmentMap to create a map. 1. upload several g:Profiler results at the same time to create one map and learn how to distinguish the results. 1. to compare the differences resulting from the use of different g:Profiler parameters at the enrichment map level. Start the exercise To start the lab practical section, first create a gprofiler_files directoty on your computer and download the files below. Right click on link below and select &quot;Save Link As...&quot;. Place it in the corresponding module directory of your CBW work directory. Five files are needed for this exercise: Enrichment result 1: gProfiler_hsapiens_GEM1.txt In g:Profiler, the parameters that we used were: GO_BP no electronic annotation, Reactome, Benjamini-HochBerg FDR 0.05. Enrichment result 2: gProfiler_hsapiens_gs250.gem.txt In g:Profiler, the parameters that we used were: GO_BP no electronic annotation, Reactome, Benjamini-HochBerg FDR 0.05. The results were filtered using the g:Profiler Term size slidebar and only the enriched gene-sets that contain equal or less than 250 genes per gene-set were included in the result file (gProfiler_hsapiens_gs250.gem.txt). Enrichment result 3: gProfiler_hsapiens_Baderlab_max250_gem.txt Pathway database 1 (.gmt):hsapiens_GO_REAC.gmt This file has been created by concatenating the hsapiens.GO/BP.name.gm and the hsapiens.REAC.name.gmt files contained in the g:Profiler gprofiler_hsapiens.name folder. Pathway database 2 (.gmt):Human_GOBP_AllPathways_no_GO_iea_June_20_2019_symbol_max250gssize.gmt Exercise 1a Step 1 Launch Cytoscape and open the EnrichmentMap App 1a. Double click on Cytoscape icon 1b. Open EnrichmentMap App In the Cytoscape top menu bar: Click on Apps -&gt; EnrichmentMap A 'Create Enrichment Map' window is now opened. Step 2 Create an enrichment map from 2 datasets and with a gmt file. 2a. In the 'Create Enrichment Map' window, drag and drop the 2 enrichment files gProfiler_hsapiens_GEM1.txt and gProfiler_hsapiens_gs250.gem.txt. 2b. In the white box, click on &quot;gProfiler_hsapiens_gs250.gem (Generic/gProfiler) 2c. On the right side, go to the GMT field, click on the 3 radio button (...) and locate the file hsapiens_GO_REAC.gmt that you have saved on your computer to upload it. 2d. In the white box, click on &quot;gProfiler_hsapiens_GEM1 (Generic/gProfiler) 2e. On the right side, go to the GMT field, click on the 3 radio button (...) and locate the file hsapiens_GO_REAC.gmt that you have saved on your computer to upload it. 2f. Locate the FDR q-value cutoff field and set the value to 0.001 2g. Select the Connectivity slide bar to sparse. 2h. Click on Build. * a status bar should pop up showing progress of the Enrichment map build. Step3: Explore the results: In the EnrichmentMap control panel located at the left: * select the 2 Data Sets (checked by default) * set Chart Data o Color by Data Set * select Publication Ready to remove gene-set label to have a global view of the map. un-select Publication Ready when you explore the map in more detail to see the gene-set names. On the map, a node that is coloured both green and blue is a gene-set that is found in the both of the 2 gProfiler result sets that we have been uploaded. * A node that is blue is a gene-set that is found only in the file gProfiler_hsapiens_GEM1 . * A blue edge represents genes that overlap between gene-sets found in the file gProfiler_hsapiens_GEM1. * A green edge represents genes that overlap between gene-sets found in the file gProfiler_hsapiens_gs250.gem. We can see clusters of blue nodes. All these nodes contain gene-sets that have more than 250 genes. Explore the detailed view (see below) to see if this cluster corresponds to informative terms. :question: Would you have lost information by filtering gene-sets larger than 250 genes? Explore Detailed results In the Cytoscape menu bar, select 'View&quot; and 'Show Graphic Details' to display node labels. Make sure you have unselected &quot;Publication Ready&quot; in the EnrichmentMap control panel. Zoom in to be able to read the labels and navigate the network using the bird eye view (blue rectangle). Select a node and visualize the Table Panel Click on a node For this example the node &quot;Signaling by Notch&quot; has been selected. you can type it in the search bar, quotes are important. When the node is selected, it is highlighted in yellow. In table panel, we can see the genes included in the gene-set. A green colored box indicates that the gene is in the gene-set(pathway) and in our gene list. A gray colored box indicated that the gene is in the gene-set but not in our gene list. Exercise 1b Create an enrichment map without a gmt file to compare the results with Exercise 1a. Go to Control Panel and select the EnrichmentMap tab. Click on the &quot;+&quot; sign to re-open the Create Enrichment Map window. In the white box, select the &quot;gProfiler_hsapiens_gs250.gem (Generic/gProfiler) file Locate the GMT field and delete the file name , leaving it blank. In the white box, select the &quot;gProfiler_hsapiens_GEM1 (Generic/gProfiler) file Locate the GMT field and delete the file name , leaving it blank. Use same parameters as in exercise 1a: FDR q-value cutoff of 0.001 and Connectivity to sparse. Click on Build Explore the results: In the EnrichmentMap control panel located at the left: * select the 2 Data Sets (selecteded by default) * set Chart Data o Color by Data Set * select Publication Ready to remove gene-set label to have a global view of the map. uncheck this box when you explore the map in details to see the gene-set names. On the map, a node that is coloured both green and blue is a gene-set that is found in the both of the 2 gProfiler result sets that we have been uploaded. * A node that is blue is a gene-set that is found only in the file gProfiler_hsapiens_GEM1 . * A blue edge represents genes that overlap between gene-sets found in the file gProfiler_hsapiens_GEM1. * A green edge represents genes that overlap between gene-sets found in the file gProfiler_hsapiens_gs250.gem. Conclusion of exercises 1 a and 1b: Loading a gmt file to create an enrichment map from g:Profiler result is optional. However, there are 2 main beneficial aspects to uploading a gmt file: 1. the map will be less condensed and easier to read and interpret. 1. clicking on a node will display all genes in the gene-set and not only genes included in our query list. Exercise 1c Create an enrichment map from the results of g:Profiler generated using the custom Baderlab gene-set file. To get a map that is easy to read and that does not display too many gene-sets, one option is to focus the analysis on gene-sets (pathways) that contain 250 genes or less. We prefiltered our pathway database prior to upload it into g:Profiler so that FDR is calculated only on these gene-sets ( as opposed to exercise 1a where the FDR was calculated on all gene-sets and then some gene-sets &gt; 250 genes were excluded from the result file ). filtered gmt file: (Human_GOBP_AllPathways_no_GO_iea_June_24_2019_symbol_max250gssize.gmt). We have uploaded this file as a custom gmt file in g:Profiler and run the query. To create an enrichment map of these results: Go to Control Panel and select the EnrichmentMap tab. Click on the &quot;+&quot; sign to re-open the Create Enrichment Map window. In the white box, select the &quot;gProfiler_hsapiens_Baderlab_max250_gem.txt (Generic/gProfiler) file Locate the GMT field and upload the file &quot;Human_GOBP_AllPathways_no_GO_iea_June_24_2019_symbol_max250gssize.gmt&quot;. Explore the results: SAVE YOUR CYTOSCAPE SESSION (.cys) FILE ! "],
["gsea-mod3.html", "Module 3: GSEA Visualization Goal of the exercise: Data GSEA output and EnrichmentMap Start the exercise", " Module 3: GSEA Visualization This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License. This means that you are able to copy, share and modify the work, as long as the result is distributed under the same license. By Veronique Voisin Goal of the exercise: Create an enrichment map and navigate through the network During this exercise, you will learn how to create an EnrichmentMap from gene-set enrichment results. The enrichment tool chosen for this exercise is GSEA but an enrichment map can be created from various gene-set tools using the generic format or the more specific g:Profiler, DAVID or BiNGO formats. Post analysis (add drug target gene-sets to the network) As second part of the exercise, you will learn how to expand the network by adding an extra layer of information. Autoannotate A last optional exercise guides you toward the creation of automatically generated cluster labels to the network. Data The data used in this exercise is gene expression data obtained from high throughput RNA sequencing. They correspond to Ovarian serous cystadenocarcinoma samples. We use precomputed results of the GSEA analysis [GSEA part] to create an enrichment map with the aim to transform the tabular format in a network to better visualize the relationships between the significant gene-sets: GSEA output and EnrichmentMap The output results of GSEA are 2 tables: One table (pos) contains all pathways with an enrichment score (significant or not) related to enrichment of the mesenchymal category (positive score). One table (neg) contains all pathways with an enrichment score (significant or not) related to enrichment of the immunoreactive category (negative score). These 2 tables are uploaded using the EnrichmentMap App which will create a network of mesenchymal and immunoreactive pathways that have a significant score (FDR &lt;= 0.0001) for clearer visualization of the results. EnrichmentMap A red circle (node) is a pathway specific of the mesenchymal type. A blue circle (node) is a pathway specific of the immunoreactive type. Green edges represent genes in common between 2 pathways (nodes). A cluster of nodes represent overlapping and related pathways and may represent a common biological process. Clicking on a node will display the genes included in each pathway. Start the exercise To start the lab practical section, first download the files. Right click on link below and select &quot;Save Link As...&quot;. Place it in the corresponding module directory of your CBW work directory. 7 Files are needed to create the enrichment map for this exercise (please download these files on your computer): GMT (file containing all pathways and corresponding genes) - Human_GOBP_AllPathways_no_GO_iea_December_24_2015_symbol.gmt Expression (file containing the RNAseq data for all samples and all genes) - MesenchymalvsImmunoreactive_rnaseq_expression.txt Enrichments 1 (GSEA results for the “pos” mesenchymal phenotype) - gsea_report_for_na_pos_1453222854028.xls Enrichments 1 (GSEA results for the “neg” immunoreactive phenotype) - gsea_report_for_na_neg_1453222854028.xls Rank file (file that has been used as input to GSEA) - MesenchymalvsImmunoreactive_edger_ranks.rnk Classes (define which samples are mesenchymal and which samples are immunoreactive) - MesenchymalvsImmunoreactive_rnaseq_classes.cls Drug target database (preselection of 4 drugs and their target genes u sed in the poast -analysis exercise, http://www.drugbank.ca/) - Human_DrugBank_approved_symbol_selected.gmt Follow the steps described below at your own pace: Step 1 Launch Cytoscape and open EnrichmentMap App 1a. Double click on the Cytoscape icon 1b. Open EnrichmentMap App In the top menu bar: Click on Apps -&gt; EnrichmentMap A 'Create EnrichmentMap window is now opened. Step 2 Create an enrichment map 2a. In the 'Create EnrichmentMap' window, add a dataset of the GSEA type by clicking on the '+' plus sign. 2b. Specify the following parameters and upload the specified files: Name: leave default or a name of your choice like &quot;GSEAmap&quot; Analysis Type: GSEA Enrichments Pos: gsea_report_for_na_pos_1453222854028.xls Enrichments Ned: gsea_report_for_na_neg_1453222854028.xls GMT : Human_GOBP_AllPathways_no_GO_iea_December_24_2015_symbol.gmt Ranks: MesenchymalvsImmunoreactive_edger_ranks.rnk Expressions : MesenchymalvsImmunoreactive_rnaseq_expression.txt. this field is optional but recommended Classes: MesenchymalvsImmunoreactive_rnaseq_classes.cls this field is optional. Phenotypes: In the text boxes place Mesenchymal as the Positive phenotype Immunoreactive as the Negative phenotype. Mesenchymal will be associated with red nodes because it corresponds to the positive phenotype and Immunoreactive will be associated with the blue nodes because it corresponds to the negative phenotype. set FDR q-value cutoff to 0.0001 (= only gene-sets significantly enriched at a value of 0.0001 or less will be displayed on the map). it will be displayed as 1E-04 in the scientific notation. 2c. Click on Build We populated the fields manually. If you work with your own data, a way to populate automatically the fields is to drag and drop your GSEA folder in the 'Data Set' window. You are encouraged to give it a try once you finished the lab with your own GSEA results. Unformatted results: layout will be different for each user (there is a random seed in the layout algorithm) but it does not change the results or interpretation (the connections are the same, only the display is different). Step 3 Navigate the enrichment map to gain a better understanding of a EnrichmentMap network. General layout of Cytoscape panel: In addition to the main window where the network is displayed, there are 2 panels: the Control Panel on the left side and the Table Panel at the bottom of the window. Steps: 3a. In the Cytocape menu bar, select View and * Show Graphic details*. It will turn the squared nodes into circles and the gene-set labels will be visible. 3b: Zoom in or out using + or - in toolbar or scroll button on mouse until you are able to read the labels comfortably. 3c: Use the bird’s eye view (located at the bottom of the control panel) to navigate around the network by moving the blue rectangle using the mouse or trackpad. 3d: Click on an individual node of interest. For this example, you could use Integrins signalling pathway. If you are unable to locate Integrins signalling pathway, type &quot;Integrins signalling pathway&quot; in the search box (quotes are important). Selected nodes appear yellow (or highlighted) in the network. 3e. In the Table Panel in the * EM Heat map* tab change: Expressions: &quot;Row Norm* Compress: -None- Genes in the heatmap that are highlighted yellowm (rank column) represent genes part of the leading edge for this gene set, i.e. contributed the most to the enriched phenotype. Leading edge genes will only be highlighted if an individual node has been selected and the Enrichment Map was created from GSEA results. Troubleshooting: if you don't see the sort column highlighted in yellow, reselect the node of interest and click on the GSEARanking Data Set 1 text in the EM Heatmap tab. Step 4 Use Filters to automatically select nodes on the map: Move the blue nodes to the left side of the window and the red nodes to the right side of the window. 4a. Locate the Select tab from the Control Panel. 4b. Click on the + sign to view the menu and select Column Filter. 4c. From the Choose column … box, select Node: ES_dataset1 and set filter values from -0.953 and 0 inclusive. 4d. The blue nodes are now automatically selected. Zoom out to be able to look at the entire network and drag all blue nodes to the left side of the screen. 4e. Optional. Change is to is not to select the red nodes. Note: the red pathways (nodes) are specific of the mesenchymal phenotype. There were listed in the pos table of the GSEA results. The enrichment score (ES) in this table are all positive values. The blue pathways are specific of the immunoreactive phenotype and were listed in the neg table of the GSEA results. The ES in this table are all negative values. This information has been used to set the filtering criteria. Step 5 Add drug target gene-sets to the network (Add Signature Gene-Sets...). 5a. In Control Panel, go to the EnrichmentMap tab and click on &quot;Add Signature Gene Sets...&quot; located below the white 'Data Sets:' window. A window named &quot;EnrichmentMap: Add Signature Gene Sets (Post-Analysis) is now opened. 5b. Using the 'Load from File...' button, select the Human_DrugBank_approved_symbol_selected.gmt file that you saved on your computer. 5c. Click on &quot;Finish&quot;. Note: Four additional nodes are now added to the network and visible as grey diamonds. Dotted orange edges represent their overlap with the nodes of our network. These additional nodes represent gene targets of some approved drugs and these genes are either specific of the mesenchymal type (dotted orange edges connected to red nodes) or specific of the immunoreactive type (dotted orange edges connected to blue nodes). more info using this link: https://enrichmentmap.readthedocs.io/en/latest/PostAnalysis.html Step 6 Auto-annotate the network with cluster labels. Important note 1: the Apps WordCloud, ClusterMaker and Autoannotate have to be installed. Important note 2: if you run step 5, delete the drug targets diamond nodes and associated edge before performing step 6: select the 4 nodes and associated dotted orange edges by browsing the mouse and click &quot;delete&quot; on your keyboard or in the Cytoscape menu, 'Edit', 'Delete Selected Nodes and Edges'. 6a. In the menu bar, select Apps, AutoAnnotate, New Annotation Set …. An Autoannotate: Create Annotation Set window pops up. Leave default settings and click on Create Annotations. In the case that an AutoAnnotate window pops up with the message AutoAnnotate will manage all groups in this network view, click OK. The network is now subdivided into clusters that are represented by ellipses. Each of these clusters are composed of pathways (nodes) interconnected by many common genes. These pathways represent similar biological processes. The app WordCloud take all the labels of the pathways in one cluster and summarize them as a unique cluster label displayed at the top of each ellipse. Tip 1: further editing and formatting can be performed on the AutoAnnote results using the AutoAnnotate Display in the Results Panels located at the right side of the window. For example, it is possible to change Ellipse to Rectangle, uncheck Scale font by cluster size and increase the Font Scale using the scaling bar. It is also possible to reduce the length of the cluster label by checking the &quot;Word Wrap&quot; option. Tip 2: The AutoAnnotate window on the left side in Result Panel contains the list of all clusters. Clicking on a cluster label will highlight in yellow all nodes in this cluster. It is then easy to move the nodes using the mouse to avoid cluster overlaps. 6b. If your network is dense and clusters are overlapping, there is an option in AutoAnnotate that you can try that expands the network to prevent cluster overlap. In the menu bar, select Apps, AutoAnnotate, New Annotation Set …. An Autoannotate: Create Annotation Set window pops up. Check the Layout network to prevent cluster overlap and click on Create Annotations. Step 7 Visualize genes in a pathway/node of interest using the apps STRING and GeneMANIA. This will create a protein-protein interaction network using the genes included in the pathway. Note: GeneMANIA theory and practical will be covered in next module. 7a: Click on an individual node of interest. For this example, you could use Integrins in angiogenesis. If you are unable to locate Integrins in angiogenesis, type &quot;Integrins in angiogenesis&quot; in the search box (quotes are important). The selected node appears yellow (or highlighted) in the network. If you have annotated your network, it should be included in the ecm receptor interaction cluster. 7b: Right Click on the node of interest to diplay the option menu. Select Apps, EnrichmentMap - Show in STRING A STRING Protein Query box appears. Unselect all genes Select None and select only the collagen genes with gene name starting with COL. Click on OK. 7c:Go back to enrichment map network. In Control Panel (left side of the window), select the &quot;Network&quot; tab and click on the Enrichment Map network as shown in below screenshot. 7d: Search again for the node labelled Integrins in angiogenesis as in Step 7a. Right Click on the node of interest to diplay the option menu. Select Apps, EnrichmentMap - Show in GeneMANIA. A GeneMANIA Query box appears. Unselect all genes Select None and select only the collagen genes with gene name starting with COL. Click on OK. It is possible to view gene expression data for the nodes in the STRING network. See the section https://enrichmentmap.readthedocs.io/en/latest/Integration.html and try it out after the workshop. SAVE YOUR FILE! "],
["module-4-in-depth-analysis-of-networks-and-pathways.html", "Module 4: In-depth Analysis of Networks and Pathways", " Module 4: In-depth Analysis of Networks and Pathways Robin Haw Lecture Lab Lecture Lab practical "],
["reactome-lab.html", "Module 4 Lab: Reactome Aim Goal Example 1: Pathway-based analysis of GBM genelist Example 2: Network-based analysis of GBM gene-sample data Example 3: Network-based analysis of OvCa somatic mutation", " Module 4 Lab: Reactome This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License. This means that you are able to copy, share and modify the work, as long as the result is distributed under the same license. Robin Haw Aim This exercise will provide you with an opportunity to perform pathway and network analysis using the Reactome Functional Interaction (FI) and the ReactomeFIViz app. Goal Analyze gene lists and somatic mutation data to identify biology that contributes to GBM and ovarian cancer. Example 1: Pathway-based analysis of GBM genelist Open up Cytoscape. Go to Apps &gt;Reactome FI&gt;Reactome Pathways. Unfurl the “Signal Transduction” events, by clicking the triangle to the left of the event name, in the “Reactome” tab on the left. Click on “Signaling by EGFR” or your favourite pathway. Right-click on highlighted pathway name to display drop-down menu, select “Show Diagram” to display Signaling by EGFR pathway. Right-click on highlighted pathway name to display drop-down menu, select “Analyze Pathway Enrichment” Upload/Browse GBM_genelist.txt into Reactome Pathway Enrichment Analysis, and click “OK”. What are the most significant biological pathways when the FDR Filter is set to 0.05? Hint: Right-click on selected pathway in Table Panel, and click “View in Diagram”. Purple-coloured nodes reflect hits in the dataset. Right-click on highlighted nodes to invoke additional features. Example 2: Network-based analysis of GBM gene-sample data Open up Cytoscape. Go to Apps&gt;Reactome FI and Select “Gene Set/Mutational Analysis”. Choose “2018 (Latest)” Version. Upload/Browse [GBM_genesample.txt](./Module4/Reactome/data/GBM_genesample.txt) file. Select “Gene/sample number pair” and Choose sample cutoff value of 4. Select “Fetch FI annotations”. Click OK. Describe the size and composition of the GBM sub-network? What are the most frequently mutated genes? Describe the TP53-PEG3 interaction, and the source information to support this interaction? Describe the data sources for the TAF1-TAF7L FI? After clustering, how many modules are there? How many pathway gene sets are there in Module 3 when the FDR Filter is set to 0.005 and Module Size Filter to 10? Hint: Analyze Module Functions&gt;Pathway Enrichment. Select appropriate filters at each step. What are the most significant pathway gene sets in Module 0, 1, 2? Hint: You don’t need to list them all! Example 3: Network-based analysis of OvCa somatic mutation Open up Cytoscape. Go to Apps&gt;Reactome FI and Select “Gene Set/Mutational Analysis”. Choose “2018 (Latest)” Version. Upload/Browse [OVCA_TCGA_MAF.txt](./Module4/Reactome/data/OVCA_TCGA_MAF.txt) file. Select “NCI MAF” (Mutation Annotation File) and Choose sample cutoff value of 4. Do not select “Fetch FI annotations”. Click OK. Describe the size and composition of the OvCa network? What are the most frequently mutated genes? After clustering, how many modules are there? How many pathway gene sets are there in Module 3 when the FDR Filter is set to 0.005 and Module Size Filter to 10? Hint: Analyze Module Functions&gt;Pathway Enrichment. Select appropriate filters at each step. What are the most significant pathway gene sets in modules, 0, 1, 2 and 7? Do the GO Biological Process annotations correlate with the significant pathway annotations for Module 1? Hint: Analyze Module Functions&gt;GO Biological Process. Select appropriate filters at each step. What are the most significant GO Cell Component gene sets in Module 0 when the FDR Filter is set to 0.005 and Module Size Filter to 10? [Optional] Hint: Analyze Module Functions&gt;GO Cell Component. Select appropriate filters at each step. Are any of the modules annotated with the NCI Disease term: “Stage_IV_Breast_Cancer” [malignant cancer]? Hint: Load Cancer Gene Index&gt;Neoplasm&gt;Neoplasm_by_Site&gt;Breast Neoplasm&gt;……. What are the targets of Docetaxel? Hint: Overlay Cancer Drugs&gt;Fetch Cancer Drugs. Maybe apply filters? How many modules are statistically significant in the CoxPH analysis? Hint: Analyze Module Functions&gt;Survival Analysis&gt;Upload/Browse [OVCA_TCGA_Clinical.txt](./Module4/Reactome/data/OVCA_TCGA_Clinical.txt). Click OK. What does the Kaplan-Meyer plot show for the most clinically significant modules? Hint: Click the most statistically significant module link [blue line] from the CoxPH results panel. Click OK. Click #_plot.pdf to display Kaplan-Meyer plot. Repeat this for the other significant module links. KM plot: samples having genes mutated in a module (green line), and samples having no genes mutated in the module (red line). Taking into consideration what you have about module 7, what is your hypothesis? Answer key "],
["reactome-lab-answers.html", "Module 4 Lab: Reactome Answers CBW Lab Module 4 Answers", " Module 4 Lab: Reactome Answers This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License. This means that you are able to copy, share and modify the work, as long as the result is distributed under the same license. Robin Haw CBW Lab Module 4 Answers Example 1 SCF-KIT, EGFR, PDGF, PI3K/AKT signaling, INSR, NGF, FGFR, etc; Example 2 The overall sub-network consists of 287 nodes and 713 edges. The largest component of the subnetwork consists of 250 nodes and 614 edges, with the remainder of nodes and edges distributed amongst 8 other small subnetworks and interactions. Couple of ways to answer this. The driver mutations are probably the frequently mutated gene in the samples. The node size is proportional to the number of samples where the gene is mutated. Method 1- Look for the largest nodes in the diagram. Method 2 – Click Node Table and sort by “sampleNumber”. The largest node is TP53, ie. mutations in the TP53 gene are highly prevalent, occurring in 100 samples. Other driver mutations include EGFR (95) and PTEN (93). Additional mutations of interest include NF1, PIK3R1, PIK3CA, PIK3R1, RYR2, RB1. Search for “TP53 PEG3” in search bar in top right of Cytoscape tool. Annotated Functional Interaction based upon data from the TRED database. This targeted interaction describes an interaction between TP53 (regulator) and PEG3 (target). An immunoprecipitation experiment demonstrates the interaction, and the supporting evidence has been published in the paper with a PubMed ID: 11679586. Search for “TAF1 TAF7L” in search bar in top right of Cytoscape tool. Predicted Functional Interaction based upon data (2/9 sources are true) from a mouse interaction database and GO (GO BP sharing). FI score: 0.53 21 modules, with 8 modules of 10 ≥ genes. 18 modules, depending on the results of the enrichment analysis. Some pathways gene sets at the cutoff threshold may come or go but those highly significant gene sets are always there. 0: TP53 Signaling 1: RTK signalling, 2: ECM and Integrin signalling. Example 3. The overall sub-network consists of 272 nodes and 569 edges. The largest component of the subnetwork consists of 240 nodes and 510 edges, with the remainder of nodes and edges distributed amongst 14 other small subnetworks and interactions. The largest node is TP53, ie. mutations in the TP53 gene are highly prevalent, occurring in at least 96% of HGS-OvCa samples. After clustering, there are 23 modules with 11 modules of 10 ≥ genes. 8 modules, depending on the results of the enrichment analysis. Some pathways gene sets at the cutoff threshold may come or go but those highly significant gene sets are always there. 0: TP53 Signaling 1: ECM and Integrin signalling, 2: EGFR Signaling and Inositol phosphate metabolism, 7: Calcium signalling-Adreneric Signaling-Cardiac Muscle Contraction, Yes, ECM and Integrin signalling. Nuclear components - Nucleoplasm, nuclear membrane, nuclear pore, chromatin, etc. Modules 0, 2 and 7 will be highlighted. Navigate through hierarchy. Neoplasm &gt; Neoplasm_by_Site &gt; Breast Neoplasm &gt; Maligant_Breast_Neoplasm &gt; Breast Carcinoma &gt; Stage_IV_Breast_Cancer. Go back to the Network Module Browser. Genes in the modules that have ‘Stage IV Breast Cancer’ annotations will be yellow-highlighted: BRCA1, NRG1, TP53, INSR, EGFR. EGFR. 3 module: 1, 3 and 7. The ReactomeFIViz app splits samples into two groups: samples having genes mutated in a module (green line), and samples having no genes mutated in the module (red line). The plugin uses the log-rank test to compare the two survival curves, and estimates p-values. In Modules 7 (KM: p= 0.00489), patient with genes mutated (green line) have a better prognosis than patients with no gene mutations (red line). Module 4 is most statistically significant modules from the CoxPH and KM analysis. In Module 7, the Calcium signaling, Chemical Synapse/Neurotransmission and Muscle Contraction annotations reflect a shared set of genes. These genes represent voltage-gated ion channels, which are a group of transmembrane ion channels that activated by changes in electrical potential difference. Even though ion channels are especially critical in neurons and muscle tissue, they are common in many types of cells, controlling the influx and outflux of ions. There are a number of genetic disorders, which disrupt normal functioning of ion channels. Calcium homeostasis is essential for cell migration, and tumor metastasis in particular. It may be that mutations in Module 7 genes disrupt calcium homeostasis, thereby impairing the tumour’s ability to metastasize, and extending patient’s overall survival. "],
["intro-regulatory-networks.html", "Module 5: Regulatory Network Analysis", " Module 5: Regulatory Network Analysis Michael Hoffman Lecture Veronique Voisin Lab lecture Lab practical "],
["regulatory-network-lab.html", "Module 5 Lab: iRegulon Lab Goal Exercise 1. Detect regulons from co-expressed genes ANSWERS EXERCISE 1 Exercise 2. Create a metatargetome using iRegulon and merge 2 networks in Cytoscape.", " Module 5 Lab: iRegulon Lab This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License. This means that you are able to copy, share and modify the work, as long as the result is distributed under the same license. By Veronique Voisin Goal Import a Cytoscape network and apply iRegulon on all the selected nodes. Explore and understand the main output features of iRegulon such as the Transcription target view. Learn how to display predicted targets of a specific transcription factor by creating its metatargetome. This practical consists of 2 exercises. You can choose to do these exercises using the questions as your only guide - or see the the step-by-step checklist to finding the answers. Some notes about iRegulon and information about the output values are written at the end of the document. Before starting the exercises, download the files: Right click on link below and select &quot;Save Link As...&quot;. Place it in the corresponding module directory of your CBW work directory. prostate_cancer_genemania_network.txt in case the iRegulon server is not working, it is possible to work with precomputed results. Please look at the instructions at the bottom of this page. Exercise 1. Detect regulons from co-expressed genes In this exercise, we will continue to use the genes from the prostate cancer list from the GeneMANIA assignment. iRegulon requires a network from the start, and we will use the GeneMANIA network that we previously saved for this purpose. Using iRegulon, we will look for transcription factors (TFs) that may regulate a set of genes in this network. To start this exercise, download to your computer the prostate_cancer_genemania_network.txt file. Skills learned in this exercise: Create a network by importing a text file, run iRegulon to detect regulons, explore the iRegulon results, create a regulon subnetwork, save the results. Steps Launch Cytoscape. Close the “Welcome to Cytoscape” window, if it’s enabled. Create a network using the ‘prostate_cancer_genemania_network.txt’ file. ● In the menu bar select ‘File &gt; Import &gt; Network from File…. A file open dialog pops up. ● Browse and locate the prostate_cancer_genemania_network.txt’ file. Click the ‘Open’ button. An “Import Network From Table” dialog pops up. ● Select the column ‘Entity 1’ . ● Expand the menu using the arrow on the right and click the green circle button to set this column as ‘Source Node’. ● Select the column ‘Entity 2’. ● Click the red bullseye to set this column as ‘Target Node’. ● Click the ‘OK’ button. The main window now displays the created network. Each node represents a gene. Edges represent the relationships (e.g physical interactions, co-expression) between the genes (nodes) that were calculated by GeneMANIA in the previous exercise. The shortcut ⌘+L (Mac) or Ctrl+L (Windows) is a quicker way to import a network from a file. Improve the layout. ● In the menu bar, select Layout &gt; Prefuse Directed Layout, weight. Select all nodes in the network. To do this using the mouse, press shift and drag from an empty space to the left of and above every node to an empty space to the right of and beneath every node. The selected nodes are now colored yellow. In the menu bar, select Apps &gt; iRegulon &gt; Predict regulators and targets. A ‘Predict regulators and targets’ dialog pops up. ● Using the default parameters, click the ‘Submit’ button at the bottom of the page. A progress bar will pop up. ● Wait until the running analysis is completed (usually less than 1 min). The progress bar will vanish, and a new right panel, “Results Panel” will be added to the main Cytoscape window. ● Deselect all nodes by clicking on a blank space of the screen. The nodes are all cyan again. Explore the results. ● Locate the ‘Results Panel’ on the right side of the window. ● Click on the ‘float window’ icon (small square) located at the upper right corner. Resize the ‘Result Panel’ window by expanding it horizontally and vertically, so you can see the results and the network simultaneously. mouse over column names to get a tooltip describing their meaning in more detail. Explore the enrichment results in the Motifs tab from the Results Panel. It is a list of all DNA binding motifs that appear in more than one gene region from the prostate cancer gene list. They are ranked by the strongest Normalized Enrichment Score (NES). Some DNA binding motifs in the databases are related to a specific transcription factor, but others are not. ● Check that ‘Motifs’ is the selected tab of the ‘Results Panel’. ● Which is the first motif with an associated TF? use the information displayed in the “TFs” column ● Click on the row for this motif to display the motif’s sequence logo and related information at the bottom part of Results Panel. ● Click on the sequence logo to zoom in on it. ● What are the potential target genes for this TF? look at the ‘Target Name’ column at the bottom right of the result panel, red font). Some explanation about the results are located at the end of this document and in more detail in the iRegulon reference paper. Explore the enrichment results in the Tracks tab. It is a list of all ChIP-seq datasets (or “tracks”) sorted by strongest enrichment from genes in our network. ● Select the ‘Tracks’ tab of the ‘Results Panel’. ● Find a ‘ClusterCode’ assigned to more than one track (eg the cluster T4 corresponds to 2 tracks). What is the name of the associated TF ('Transcription Factor Name')? ● What is the difference between the two tracks? ● Compare and contrast the target genes for the two tracks. Explore the enrichment results in the Transcription Factors tabview. Each row is a TF that is a potential co-regulator of the genes in our network. Each row represents a cluster that combines related motifs or tracks or both. ● Select the ‘Transcription Factors’ tab of the ‘Results Panels’. ● Click on ‘MTF1’ and explore the results. How did iRegulon perform? Is MTF1 (metal-transcription factor 1) known to be expressed or to play a role in prostate cancer? Open your web browser and search the web for [MTF1 “prostate cancer”]. Add MTF1 to the network. ● Check that the Transcription Factors tab is selected. ● Click the MTF1 row to select it. ● Click the ‘Add regulator’ icon located at the upper left corner of the ‘Results Panel’. This adds MTF1 to the network as a yellow node, with the edges linking to its 11 potential targets, all highlighted as purple nodes. Create a subnetwork to better visualize the predicted targets. ● Select the MTF1 node in the network by clicking on it. ● In the Cytoscape toolbar above the network, click the ‘First Neighbors of Selected Nodes’ icon . MTF1 and its targets are now highlighted in yellow (which means they are selected). ● Use the ‘New network from selection’ icon to create a subnetwork. As the file (‘prostate_cancer_genemania_network.txt’) that we have used to create the network in step 1 is a geneMANIA network, it contains the source of interactions between the nodes: the co-expression, co-localization, physical interaction, predicted interactions and shared protein domains networks. In this step, we will color the edges based on the geneMANIA interaction networks: ● In the Control Panel at the left of the window, select the ‘Style’ tab. At the bottom of the panel, select the ‘Edge’ tab. ● Locate the ‘Stroke Color’ property and click the right triangle to expand the box. ● Change the ‘Column’ field to ‘Network group’ ● Verify that the ‘Mapping Type’ field is ‘Discrete Mapping’ ● A number of different interaction types such as &quot;co-expression&quot; should appear. For the first of these interaction types, choose a color by clicking on the ‘Edit color’ button on the right side of the color field. Choose a color and click the ‘OK’ button. ● Repeat that step, choosing a different color for each interaction type. The edges should now be colored by the types of interactions. Save current results as an iRegulon (iRF) file. ● In the ‘Results Panel’ toolbar, click the ‘Save current results as an iRegulon (iRF) file’ button . ● Choose a name and click the ‘Save’ button. you can reuse these iRegulon results by loading this iRF file using the ‘Load saved results’ icon .. Save the Cytoscape session . ● In the Cytoscape menu bar, select File &gt; Save as. ● Choose a name and click the ‘Save’ button. you can re-open this file later to examine the network further. ANSWERS EXERCISE 1 Launch Cytoscape. Close the “Welcome to Cytoscape” window, if it’s enabled. Double click on the . Cytoscape icon. Create a network using the ‘prostate_cancer_genemania_network.txt’ file. ● In the menu bar select ‘File &gt; Import &gt; Network &gt;File…. A file open dialog pops up. ● Browse and locate the prostate_cancer_genemania_network.txt’ file. Click the ‘Open’ button. An “Import Network From Table” dialog pops up. ● Select the column ‘Entity 1’ . ● Expand the menu using the arrow on the right and click the green circle button to set this column as ‘Source Node’. ● Select the column ‘Entity 2’. ● Click the red bullseye to set this column as ‘Target Node’. ● Click the ‘OK’ button. The main window now displays the created network. Each node represents a gene. Edges represent the relationships (e.g physical interactions, co-expression) between the genes (nodes) that were calculated by GeneMANIA in the previous exercise. The shortcut ⌘+L (Mac) or Ctrl+L (Windows) is a quicker way to import a network from a file. 2a) 2a 2b) 2b 2c) 2c 2d) 2d 2e) 2e Improve the layout. ● In the menu bar, select Layout &gt; Files Layouts &gt; Organic. 3a) 3a 3b) 3b Select all nodes in the network. To do this using the mouse, drag from an empty space to the left of and above every node to an empty space to the right of and beneath every node. The selected nodes are now colored yellow. 4 In the menu bar, select Apps &gt; iRegulon &gt; Predict regulators and targets.A ‘Predict regulators and targets’ dialog pops up. ● Using the default parameters, click the ‘Submit’ button at the bottom of the page.A progress bar will pop up. ● Wait until the running analysis is completed (usually less than 1 min). The progress bar will vanish, and a new right panel, “Results Panel” will be added to the main Cytoscape window. ● Deselect all nodes by clicking on a blank space of the screen. The nodes are all cyan again. 5a) 5a 5b) 5b Explore the results. ● Locate the ‘Results Panel’ on the right side of the window. ● Click on the ‘float window’ icon located at the upper right corner. resize the ‘Result Panel’ window by expanding it horizontally and vertically, so you can see the results and the network simultaneously. mouse over column names to get a tooltip describing their meaning in more detail. 6 Explore the enrichment results in the Motifs tab from the Results Panel. It is a list of all DNA binding motifs that appear in more than one gene region from the prostate cancer gene list. They are ranked by the strongest Normalized Enrichment Score (NES). Some DNA binding motifs in the databases are related to a specific transcription factor, but others are not. ● Check that ‘Motifs’ is the selected tab of the ‘Results Panel’. ● Which is the first motif with an associated TF? ( use the information displayed in the “TFs” column. ● Click on the row for this motif to display the motif’s sequence logo and related information at the bottom part of Results Panel. ● Click on the sequence logo to zoom in on it. ● What are the potential target genes for this TF? look at the ‘Target Name’ column. some explanation about the results are located at the end of this document and in more detail in the iRegulon reference paper. 7 Explore the enrichment results in the Tracks tab. It is a list of all ChIP-seq datasets (or “tracks”) sorted by strongest enrichment from genes inour network. ● Select the ‘Tracks’ tab of the ‘Results Panel’. ● Find a ‘ClusterCode’ assigned to more than one track. What is the name of the associated TF? ● What is the difference between the two tracks? ● Compare and contrast the target genes for the two tracks. 8 Answer: T4 is a track cluster associated with 2 tracks. The first track is ranked number 4 and the second track is ranked number 8. The transcription factor is TCF12. The 2 tracks are probably biological replicates (Rep1, Rep2) of a same Chip-seq experiment. They have only 1 target in common (DHRS2) but 4 targets (DHRS) are from the same protein family (shared protein domains). On the Transcription Factors view (see section below), all these target genes are combined under cluster T4 corresponding to TCF12. T7 is also associated with 2 tracks and correspond to SMC3. Explore the enrichment results in the Transcription Factors tabview. Each row is a TF that is a potential co-regulator of the genes in our network. Each row represents a cluster that combines related motifs or tracks or both. ● Select the ‘Transcription Factors’ tab of the ‘Results Panels’. ● Click on ‘MTF1’ and explore the results. 9 Answer: MTF1 is associated with the motif cluster M1. This cluster contains 6 related motifs and 11 potential target genes. One motif (homer-M00129) selected as example in the above screenshot is directly annotated to the TFs NRF1 and ZSCAN10 as indicated by green checked signs. How did iRegulon perform? Is MTF1 (metal-transcription factor 1) known to be expressed or to play a role in prostate cancer? Open your web browser and search the web for [MTF1 “prostate cancer”]. 10 This network MTF1 within genes and miRs important for prostate cancer. PMID:14568174 PMID:23157640 Add MTF1 to the network. ● Check that the Transcription Factors tab is selected. ● Click the MTF1 row to select it. ● Click the ‘Add regulator’ icon located at the upper left corner of the ‘Results Panel’. This adds MTF1 to the network as a yellow node, with the edges linking to its 11 potential targets, all highlighted as purple nodes. 11a) 11a 11b) 11b Create a subnetwork to better visualize the predicted targets. ● Select the MTF1 node in the network by clicking on it. ● In the Cytoscape toolbar above the network, click the ‘First Neighbors of Selected Nodes’ icon . MTF1 and its targets are now highlighted in yellow (which means they are selected). ● Use the ‘New network from selection’ icon to create a subnetwork. 12a) 12a 12b) 12b Add to the figure information on the types of interactions obtained from GeneMANIA and stored as additional information in the ‘prostate_cancer_genemania_network.txt’ file. ● In the Control Panel at the left of the window, select the ‘Style’ tab. At the bottom of the panel, select the ‘Edge’ tab. ● Locate the ‘Stroke Color’ property and click the right triangle to expand the box. ● Change the ‘Column’ field to ‘Network group’ ● Verify that the ‘Mapping Type’ field is ‘Discrete Mapping’ ● For the first interaction type, choose a color by clicking on the ‘Edit color’ button on the right side of the color field. Choose a color and click the ‘OK’ button. ● Repeat that step, choosing a different color for each interaction type. The edges should now be colored by the types of interactions. 13a) 13a 13b) 13b Save current results as an iRegulon (iRF) file. ● In the ‘Results Panel’ toolbar, click the ‘Save current results as an iRegulon (iRF) file’ button .. ● Choose a name and click the ‘Save’ button. you can reuse these iRegulon results by loading this iRF file using the ‘Load saved results’ icon .. 14a) 14 Save the Cytoscape session . ● In the Cytoscape menu bar, select File &gt; Save as. ● Choose a name and click the ‘Save’ button. you can re-open this file later to examine the network further. 15 Exercise 2. Create a metatargetome using iRegulon and merge 2 networks in Cytoscape. This exercise does not require additional files. This exercise will teach you to use the metatargetome function of iRegulon. This function displays a list of potential targets for a specific TF. We will create the metatargetome of two TFs, that we found as potential coregulators of the prostate cancer genes (exercise 1): MTF1 and LARP4. We will then learn how to use Cytoscape to merge two networks and visualize nodes in common. Steps Launch Cytoscape. If Cytoscape is already opened, do File &gt; New &gt; Session. A ‘Current session will be lost. Do you want to continue?’ dialog opens. Click on ‘OK’. Create the metatargetome for MTF1. ● From the menu bar , select Apps &gt; iRegulon &gt; Query TF-target database.A ‘Query TF-target database for a factor’ window pops up. ● In the ‘Transcription Factor’ field, select ‘MTF1’. ● Set Network &gt; ‘Number nodes (approx.)’ to 100. ● Click the ‘Submit’ button. Create the metatargetome for LARP4. Follow same steps as above. ● From the Cytoscape menu bar, select Apps &gt; iRegulon &gt; Query TF-target database. ● A ‘Query TF-target database for a factor’ window pops up. In the ‘Transcription Factor field’, enter ‘LARP4’. ● Set Network &gt; ‘Number nodes (approx.)’ to 100. ● Click the ‘Submit’ button. Merge the two networks to visualize their shared target genes. From the Cytoscape menu bar, select Tools &gt; Merge &gt; Networks….An ‘Advanced Network Merge’ window pops up. ● Check that the ‘Union’ option is selected. ● In the ‘Available Networks’ list, select ‘Metatargetome for LARP4’. ● Hold down the shift key while selecting ‘Metatargetome for MTF1’ so both networks are selected. ● Click the right arrow to move the networks to the ‘Networks to Merge’ list. ● Click the ‘Merge’ button. Cytoscape now displays the two networks in the same window, linked by the two genes they have in common. ANSWERS EXERCISE 2 Launch Cytoscape. If Cytoscape is already opened, do File &gt; New &gt; Session. A ‘Current session will be lost. Do you want to continue?’ dialog opens. Click on ‘OK’. Double click on the Cytoscape icon. Create the metatargetome for MTF1. ● From the menu bar , select File &gt; Apps &gt; iRegulon&gt; Query TF-target database.A ‘Query TF-target database for a factor’ window pops up. ● In the ‘Transcription Factor’ field, select ‘MTF1’. ● Set Network &gt; ‘Number nodes (approx.)’ to 100. ● Click the ‘Submit’ button. 2a) 2a2 2b) 2b2 2c) 2c2 Create the metatargetome for LARP4. Follow same steps as above. ● From the Cytoscape menu bar, select File &gt; Apps&gt;iRegulon&gt; Query TF-target database. ● A ‘Query TF-target database for a factor’ window pops up. In the ‘Transcription Factor field’, enter ‘LARP4’. ● Set Network &gt; ‘Number nodes (approx.)’ to 100. ● Click the ‘Submit’ button. 3a) 3a2 3b) 3b2 Merge the two networks to visualize their shared target genes. From the Cytoscape menu bar, select Tools &gt; Merge &gt; Networks….An ‘Advanced Network Merge’ window pops up. ● Check that the ‘Union’ option is selected. ● In the ‘Available Networks’ list, select ‘Metatargetome for LARP4’. ● Hold down the shift key while selecting ‘Metatargetome for MTF1’ so both networks are selected. ● Click the right arrow to move the networks to the ‘Networks to Merge’ list. ● Click the ‘Merge’ button. Cytoscape now displays the two networks in the same window, linked by the two genes they have in common. 4a) 4a2 4b) 4b2 4c) 4c2 END OF EXERCISE Use or precomputed iRegulon results: Download these files on your computer: Right click on link below and select &quot;Save Link As...&quot;. Place it in the corresponding module directory of your CBW work directory. prostate_cancer_genemania_network.cys iregulon_results.irf launch Cytoscape open the &quot;prostate_cancer_genemania_network.cys&quot; file go to App &gt; iRegulon &gt; 'Load results from the iregulon_results.irf file' Notes about iRegulon: Website: http://iregulon.aertslab.org/ Tutorials: http://iregulon.aertslab.org/tutorial.html#clusters Paper: http://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1003731 [PMID:25058159] Motif oriented view: Each line is a DNA binding motif those sequence has been located in 20 kb regions centered around the TSS (transcription start site) of genes from the prostate cancer list (= genes in the network). The genes from the network which contained this DNA binding motif are called the target genes and displayed in the ‘Target Name’ column. Their ranks are also indicated. DNA binding motifs more usually represent a family of transcription factors (e.g. helix loop helix TFs ) rather than being specific to one particular TF. In addition, related TFs (e.g GATA1, GATA2, GATA3) can bind to very similar DNA sequences. iRegulon uses the motif2TF algorithm to associate a motif with a specific TF. The ‘#TF’ column indicates which motifs are significantly associated to a TF (# &gt;= 1) or not (# = 0). Clicking on a motif line will display a panel indicating several related information. It will display all the TFs found significantly associated with the motif. How is the enrichment calculated? (NES AUC) motif detection and enrichment score in a set of input genes. iRegulon uses precomputed results to calculate for each motif the AUC (Area Under the cumulative Recovery Curve) and the NES (Normalized Enrichment Score). iRegulon accesses this database of precomputed results using a server connection when a search is launched. What are these precomputed results : iRegulon gathered known DNA binding motifs and their corresponding PWM (position weight matrix, see lecture) from different databases (eg TRANSFAC pro) (9713 PWMs). They then ranked all genes in the genome (22284 genes) for each motif from the most likely target of this motif to the least one (available for Human, Mouse and Drosophila). Calculating enrichment for our set of genes (our network) : Each ranked list (each motif) is then tested with our set of genes to see whether genes in our list are located more at the top of the ranked list (most likely targets of the motifs). From this ranked list and the overlap with our gene list, the AUC (Area Under the cumulative Recovery Curve) is calculated for each motif. The AUC is going to be larger if we have more genes at the top of our list. The higher the AUC values and the higher the tested motif is likely to co-regulate our genes (or some of them). The NES is derived from the AUC. The optimal subset of highly ranked lists are set as the potential target genes and displayed in the ‘target name’ column. How are several motifs being similarly grouped under a same cluster code? To find TF associated with motifs, iRegulon uses the motif2TF algorithm. During this computation of motif2TF, motifs sharing similarities are grouped together and form a cluster. Within this cluster, some motifs are already known to correspond to a specific TF (direct annotation). This information is used to associate a motif with one or more related TFs. The ‘ClusterCode’ column indicates the cluster assigned to each motif. Tracks oriented view: Each line is an ENCODE Chip_Seq track. Chip_seq are sequencing of fragments bound to a specific TF after immunoprecipitation of the TF and the DNA fragments. Each track is then specific to a transcription factor (the #TFs columns is always equal to 1). Clusters contain more than one track only if these tracks were generated using the same TF. All the values (NES, AUC,... are the same for the motif, track of transcription factor oriented views. Transcription Factors oriented view: Each line is a cluster of motifs and or tracks and as the next column (TF) the best representative TF of this cluster determined by the motif2TF algorithm. All the values (NES, AUC,... are the same for the motif, track of transcription factor oriented views. Metatargetome: iRegulon uses the pre-computed results not only for finding regulons but also for displaying the potential gene targets for any TF of interest available in the iRegulon database. Users can define the number of top potential targets they want to display. The result is visualized as a network using a circular layout with the TF of interest in the center of the network. Notes about Cytoscape: Link to tutorials showing how to format data to create a Cytoscape network starting from a simple gene list: http://wiki.cytoscape.org/Cytoscape_User_Manual/Network_Formats Note about organic layout: “The organic layout style is based on the force-directed layout paradigm. When calculating a layout, the nodes are considered to be physical objects with mutually repulsive forces, like, e.g., protons or electrons. The connections between nodes also follow the physical analogy and are considered to be springs attached to the pair of nodes. … The layout algorithm simulates these physical forces and rearranges the positions of the nodes in such a way that the sum of the forces emitted by the nodes and the edges reaches a (local) minimum. Resulting layouts often expose the inherent symmetric and clustered structure of a graph, they show a well-balanced distribution of nodes and have few edge crossings.” http://docs.yworks.com/yfiles/doc/developers-guide/smart_organic_layouter.html . "],
["module-6-gene-function-prediction.html", "Module 6: Gene Function Prediction", " Module 6: Gene Function Prediction Veronique Voisin Lecture Lab practical - Cytoscape Lab practical - Web "],
["genemania-cytoscape.html", "Module 6 Lab: GeneMANIA (Cytoscape version) Goal of this practical lab EXERCISE 1: QUESTIONS AND STEPS TO FOLLOW EXERCISE 1 ANSWERS: DETAILED EXPLANATION AND SCREENSHOTS EXERCISE 2: QUESTIONS AND STEPS TO FOLLOW EXERCISE 2 ANSWERS: DETAILED STEPS AND SCREENSHOTS EXERCISE 3: QUESTIONS AND STEPS TO FOLLOW Exercise 3: MORE DETAILS AND SCREENSHOTS SOME DEFINITIONS:", " Module 6 Lab: GeneMANIA (Cytoscape version) This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License. This means that you are able to copy, share and modify the work, as long as the result is distributed under the same license. By Quaid Morris and Veronique Voisin Goal of this practical lab Create GeneMANIA networks starting from a single gene to predict its function or starting from a gene list. Explore and understand the main output features of GeneMANIA such as the network composition or the enriched functions. This practical consists of 3 exercises. You can choose to do these exercises using the questions as your only guide (section 'QUESTIONS AND STEPS TO FOLLOW) - or see the following pages for the step-by-step checklist to finding the answers (section 'ANSWERS: DETAILED STEPS AND SCREENSHOTS'). Before starting the exercises,download the files: Right click on link below and select &quot;Save Link As...&quot;. Place it in the corresponding module directory of your CBW work directory. 30_prostate_cancer_genes.txt Mixed_gene_list.txt CYP11B_pearson_correlation_prostate.txt Network layouts are flexible and can be rearranged. What you see when you perform these exercises may not be identical to what you see in the tutorial, or what you have seen other times that you have performed the exercises. Exact layouts and predictions can also be affected by updates to the networks database that GeneMANIA uses. However it is expected that the network weights and predicted genes will be similar to those shown here. EXERCISE 1: QUESTIONS AND STEPS TO FOLLOW Imagine that you are interested in exploring the function of the human GRN gene: GRN returned as the strongest hit from your omics experiment but not many information about this gene is available in functional databases. Use GeneMANIA to identify its predicted function as well as potential interaction partners. Skills: GeneMANIA Single Gene search; Navigating Search Results; Exploring available Genes features; Rerun a new analysis using a single gene or multiple genes query from the network. STEPS Open Cytoscape. Locate the GeneMANIA search window located on the left side in Control Panel. In the search window, ensure that the model organism is set to Homo sapiens . Enter the following gene: GRN Click on the search icon and wait for the results. When your search results load, examine the network. Genes you searched with are indicated in black, related genes added by GeneMANIA are represented in gray, and colored links represent the interactions that connect the nodes (genes). zoom in and zoom out using trackpad or mouse scrolling up and down. Locate the Functions summary tab in Results Panel. What are the functions significantly associated with this network? GRN is the central node of this network: which function would you predict for GRN? How well did GeneMANIA perform (hints: use GeneCards (http://www.genecards.org/) , PubMed (http://www.ncbi.nlm.nih.gov/pubmed/))? Locate the gene with the strongest association with GRN. this gene is the largest node on the network. Re-run an analysis by adding SORT1, HSPG2 to the search. Type 'SORT1' and 'HSPG2' in the search box that already contains 'GRN' (one gene per line). Click on the search button. Which functions are associated with this new network? Save the network as an image by clicking on 'File', 'Export', 'Network to Image...' and setting the &quot;Export File Format&quot; to &quot;PDF(*.pdf)&quot;. EXERCISE 1 ANSWERS: DETAILED EXPLANATION AND SCREENSHOTS EXERCISE 1 - STEPS 1-5 EXERCISE 1 - STEP 6 Exercise 1 - STEP 7 Question What are the functions significantly associated with this network? Answer the list of the functions associated with the network are listed in the above screenshot. &quot;lysosomal function&quot;, &quot;vacuolar lumen&quot;, &quot;vacuolar part&quot; are significant under a FDR threshold less than 0.0001. Question GRN is the central node of this network: which function would you predict for GRN? Answer : a function related to lysosome and vacuole Question How well did GeneMANIA perform (hints: use GeneCards (http://www.genecards.org/) , PubMed (http://www.ncbi.nlm.nih.gov/pubmed/))? Answer The top functions predicted by GeneMANIA for GRN were related to lysosome and vacuole. A pubmed search could confirm these results: “We experimentally verified that granulin precursor (GRN) gene, whose mutations cause frontotemporal lobar degeneration, is involved in lysosome function.” (Transcriptional gene network inference from a massive dataset elucidates transcriptome organization and gene function. Belcastro et al. Nucleic Acids Res. 2011 Nov 1;39(20):8677-88. 2011. PMID:21785136) Exercise 1 - STEP 8 Question Locate the gene with the strongest association with GRN (thick edge). Answer is SORT1 Exercise 1 - STEP 9 Exercise 1 - STEP 10 (save an image) Notes about biological interpretation of the results: A paper describing the interaction between GRN and SORT1 and demonstrates how finding related genes could be relevant for elaborating therapy: Targeted manipulation of the sortilin–progranulin axis rescues progranulin haploinsufficiency. Lee et al. Hum Mol Genet. 2014 March 15; 23(6): 1467–1478. Published online 2013 October 26. doi: 10.1093/hmg/ddt534. PMCID:PMC3929086 “Progranulin (GRN) mutations causing haploinsufficiency are a major cause of frontotemporal lobar degeneration (FTLD-TDP). Recent discoveries demonstrating sortilin (SORT1) is a neuronal receptor for PGRN endocytosis and a determinant of plasma PGRN levels portend the development of enhancers targeting the SORT1–PGRN axis. We demonstrate the preclinical efficacy of several approaches through which impairing PGRN's interaction with SORT1 restores extracellular PGRN levels. “ GM11 EXERCISE 2: QUESTIONS AND STEPS TO FOLLOW To start this exercise, you need to download the 30_prostate_cancer_genes.txt file from the course wiki and save it on your computer. For this exercise, you are working with a list of 30 prostate cancer genes. This list can be downloaded after the workshop from the cBioPortal website (http://www.cbioportal.org/) under the download section, user defined list. The cBioPortal for Cancer Genomics stores genomic data from large scale, integrated cancer genomic data sets. During this exercise, you will explore the types of networks that have been used to create the GeneMANIA network from the prostate cancer gene list and you will see how changing input parameters can affect the results. The last step of the exercise consists of uploading a custom network which is a list of genes that are positively correlated with CYP11B1 in mRNA expression data of 94 prostate cancer samples (http://www.cbioportal.org/) . Skills: GeneMANIA search using a gene list; Navigating Search Results; Exploring Networks and advanced options; Uploading a custom network. STEPS Open Cytoscape. Locate the GeneMANIA search window located on the left side in Control Panel. Copy and paste genes in the file 30_prostate_cancer_genes.txt. Make sure that the parameter 'Max resultant genes' is set to '20' by clicking on the menu button at the right side of the search box and selecting 'Customise advanced options'. Click on the search icon and wait for the results. When your search results load, examine the network. Genes you searched with are indicated in black, related genes added by GeneMANIA are represented in gray, and colored links represent the interactions that connect the nodes (genes). Move nodes around by selecting them with a mouse to investigate how they are connected. Click any link (edge) connecting two nodes to highlight information about it. The information about the interaction is display in the Edge Table located in Table Panel (at the bottom) in the networks and data type columns. Note: Clicking on an edge between 2 nodes will display information about all interaction networks that connect these 2 nodes. It indicates the reference (publication) for these interactions. The colors indicate the type of interaction (co-expression, shared protein domains, co-localization, physical interactions and predicted). Locate and expand the 'Networks' summary tab in Results Panel (on the right) and look at what data has been used to create the network and predictions. Note that Co-expression (purple colored lines, weight over 25%) and Shared protein domains (lightgold colored lines, weight over 30%) influence the results the most, but Co-localization (blue colored lines), Physical interactions (salmon colored lines) and Predicted (orange) data are also included. At the top of the Networks summary tab, use the menu button and try Expand “All, then “Top-Level” and “None” to get information about the sources of the different networks. Highlight all connections corresponding to each network by clicking the name of each network category. Click on “Shared protein domains” and see which genes are connected by predicted protein protein interaction. You can do the same for “Co-localization” , “Co-expression” and “Physical interactions”. these observations of the number of connections make it easier to understand why co-expression and shared protein domains get the higher percent weight on this network: they are helping to connect more genes than physical interactions and predicted; A higher weight means that this network helped more to find related genes. Locate the Functions summary tab and look at what functions were significantly enriched in this list of prostate genes. “Shared protein domains” is an important part of the network. What would be the GeneMANIA results if we don’t include this source when we run GSEA? In Control Panel, click on the option menu button which is located at the right of the search box. Uncheck ‘Shared protein domains’ and click on a point outside the box to close it. Click on the search icon . Explore the results. Locate the Functions summary tab in Results Panel and look at what functions were significantly enriched with these new settings. Try to modify additional parameters like Max Resultant Genes or Network Weighting and look at how the changes you made influenced the results. EXERCISE 2 ANSWERS: DETAILED STEPS AND SCREENSHOTS Exercise 2 - STEPS 1 to 4 check that the parameter 'Max resultant genes' is set to '20': Exercise 2 - STEP 5 Exercise 2 - STEP 7 Exercise 2 - STEP 8 Exercise 2 - STEP 9 The top pathways with the strongest enrichments are: &quot;cellular hormone metabolic process&quot; with 23 genes in the list overlapping with this pathway. The FDR is equal to 1.2e-40. ##### ### Exercise 2 - STEP 10 Question “Shared protein domains” is an important part of the network. What would be the GeneMANIA results if we don’t include this source when we run GSEA? Answer If &quot;shared protein domain&quot; is removed, the relationships between the nodes are from the Co-expression, Co-localization, Predicted and Physical interactions networks. The genes added to the network are different compared to the first network created with &quot;Shared protein domain&quot;. Exercise 2 - STEP 11 Question what functions were significantly enriched with these new settings. Answer With the new settings, &quot;hormone biosynthetic process&quot; is the new top enriched pathway. EXERCISE 3: QUESTIONS AND STEPS TO FOLLOW To start this exercise, you need to download the Mixed_gene_list.txt file and save it on your computer. For this exercise, you are working on a gene list created by combining 3 user defined gene lists available from the cBioportal (http://www.cbioportal.org). It contains genes implicated in the DNA damage response, the PI3K-AKT-mTOR signaling pathway and Folate transport. This list is representative of a gene list obtained from transcriptomics data. During this exercise, we will first characterize our gene list based on functions and then we will add potential drug and microRNAs targeting genes in the network, and we will save the report. Skills: GeneMANIA search using a gene list; Navigating Search Results; Exploring Functions; Adding attributes; Create a report. STEPS Open Cytoscape and locate the GeneMANIA search window located on the left side in Control Panel. make sure that GeneMANIA is selected and not String. In the search window, ensure that the model organism is set to Homo sapiens . Copy and paste genes in the file Mixed_gene_list.txt. Click on the search icon and wait for the results. Explore the network. Locate the Functions summary tab in Result Panel and look at functions returned by GeneMANIA. In the functions summary tab, check some functions to color genes included in these functions. To follow this tutorial, you can for example color the “response to insulin” , “DNA recombination” functions. You need to scroll down to found DNA recombination as this pathway has an FDR greater than the one for “response to insulin”. To color genes: Go to Control Panel and select the Style tab. In the Nodes panel, expand the Fill Color tab. Set Column to annotation name. Locate “DNA recombination”. Double click on the white space at the right side of the box and click on the 3 dots . A Colors box appears. Choose a color of your choice and click on OK. Locate “response to insulin”. Double click on the white space at the right side of the box and click on the 3 buttons menu. A Colors box appears. Choose a color of your choice and click on OK. Locate our favorite gene PDPK1 on the network. Click on the icon First Neighbor of Selected Nodes . It will highlight this gene and all its connections. Click on the icon New Network from Selection (All Edges) to create a subnetwork. copy &quot;PDPK1&quot; in the search box and the node will be highlighted in yellow. Exercise 3: MORE DETAILS AND SCREENSHOTS Exercise 3 - STEPS 1 - 2 Exercise 3 - STEP 3 Exercise 3 - STEP 4 Exercise 3 - STEP 5 Exercise 3 - STEPS 6 SOME DEFINITIONS: What are the networks: Definition of the types of interaction: Shared domains: Protein domain data. Two gene products are linked if they have the same protein domain. These data are collected from domain databases, such as InterPro, SMART and Pfam. Co-localization: Genes expressed in the same tissue, or proteins found in the same location. Two genes are linked if they are both expressed in the same tissue or if their gene products are both identified in the same cellular location. Co-expression: Gene expression data. Two genes are linked if their expression levels are similar across conditions in a gene expression study. Most of these data are collected from the Gene Expression Omnibus (GEO); we only collect data associated with a publication. Predicted: Predicted functional relationships between genes, often protein interactions. A major source of predicted data is mapping known functional relationships from another organism via orthology. What is defined by evidence sources?: Evidence sources are the information contained in the multiple databases that GeneMANIA uses to establish interaction between two genes. Network: Node : circle representing the genes Edge: line that links two nodes and represent an interaction between two genes (multiple lines correspond to multiple sources Node size: Mapped to gene score, i.e. the degree to which GeneMANIA predicts the genes are related Thickness of edge: Strength/weight of interaction Layout : The layout is different each time so the user can request the layout run multiple times until the user is satisfied with the result. in Networks tab: Percent weight (score) : a higher weight means that this network helped more to find related genes. in Functions tab : FDR : False discovery rate (FDR) is greater than or equal to the probability that this is a false positive. Coverage : (number of genes in the network with a given function) / (all genes in the genome with the function) In advanced options: Network weighting? GeneMANIA can use a few different methods to weight networks when combining all networks to form the final composite network that results from a search. The default settings are usually appropriate, but you can choose a weighting method in the advanced option panel. (more details at http://pages.genemania.org/help/). Related genes : are genes added by GeneMANIA in addition to the genes from the query. It helps to grow the network and then to predict function of the query gene(s). The attributes represent the differences sources of evidence that can be used to build the network. Notes : prostate cancer gene list is “AKR1C3 AR CYB5A CYP11A1 CYP11B1 CYP11B2 CYP17A1 CYP19A1 CYP21A2 HSD17B1 HSD17B10 HSD17B11 HSD17B12 HSD17B13 HSD17B14 HSD17B2 HSD17B3 HSD17B4 HSD17B6 HSD17B7 HSD17B8 HSD3B1 HSD3B2 HSD3B7 RDH5 SHBG SRD5A1 SRD5A3 STAR”. mixed gene list is AKT1 AKT1S1 AKT2 ATM ATR BRCA1 BRCA2 CHEK1 CHEK2 FANCF FOLR1 FOLR2 FOLR3 FOXO1 FOXO3 MDC1 MLH1 MLST8 MSH2 MTOR PARP1 PDPK1 PIK3CA PIK3R1 PIK3R2 PTEN RAD51 RHEB RICTOR RPTOR SLC19A1 TSC1 TSC2 look at GeneMANIA help pages when you run an analysis on your own after the workshop: http://pages.genemania.org/help/. "],
["genemania-web.html", "Module 6 Lab: GeneMANIA (web version) Goal of this practical lab EXERCISE 1: QUESTIONS AND STEPS TO FOLLOW EXERCISE 1 ANSWERS: DETAILED EXPLANATION AND SCREENSHOTS EXERCISE 2: QUESTIONS AND STEPS TO FOLLOW EXERCISE 2 ANSWERS: DETAILED STEPS AND SCREENSHOTS EXERCISE 3: QUESTIONS AND STEPS TO FOLLOW Exercise 3: MORE DETAILS AND SCREENSHOTS SOME DEFINITIONS:", " Module 6 Lab: GeneMANIA (web version) This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License. This means that you are able to copy, share and modify the work, as long as the result is distributed under the same license. By Veronique Voisin Goal of this practical lab Create GeneMANIA networks starting from a single gene to predict its function or starting from a gene list. Explore and understand the main output features of GeneMANIA such as the network composition or the enriched functions. This practical consists of 3 exercises. You can choose to do these exercises using the questions as your only guide (section 'QUESTIONS AND STEPS TO FOLLOW) - or see the following pages for the step-by-step checklist to finding the answers (section 'ANSWERS: DETAILED STEPS AND SCREENSHOTS'). Before starting the exercises,download the files: Right click on link below and select &quot;Save Link As...&quot;. Place the file in your CBW work directory in the corresponding module directory. 30_prostate_cancer_genes.txt Mixed_gene_list.txt CYP11B_pearson_correlation_prostate.txt Optional exercise: try to redo these exercises using the Cytoscape GeneMANIA application. Network layouts are flexible and can be rearranged. What you see when you perform these exercises may not be identical to what you see in the tutorial, or what you have seen other times that you have performed the exercises. Exact layouts and predictions can also be affected by updates to the networks database that GeneMANIA uses. However it is expected that the network weights and predicted genes will be similar to those shown here. EXERCISE 1: QUESTIONS AND STEPS TO FOLLOW Imagine that you are interested in exploring the function of the human GRN gene: GRN returned as the strongest hit from your omics experiment but not many information about this gene is available in functional databases. Use GeneMANIA to identify its predicted function as well as potential interaction partners. Skills: GeneMANIA Single Gene search; Navigating Search Results; Exploring available Genes features; Rerun a new analysis using a single gene or multiple genes query from the network. STEPS Go to GeneMANIA’s homepage at http://www.genemania.org/ In the search window, ensure that the model organism is set to Homo sapiens . Enter the following gene: GRN Click on the search icon and wait for the results. When your search results load, examine the network. Genes you searched with are indicated with stripes, related genes added by GeneMANIA are represented in black, and colored links represent the interactions that connect the nodes (genes). Tip: zoom in and zoom out using trackpad or mouse scrolling up and down using the mouse or trackpad or zoom in to the maximum using the specific icon . Clicking on a node gives information about the name of gene, the possibility to add, remove this gene or search with this gene only. Click on the GRN node and explore the displayed information. Locate the Functions summary tab (bottom left icon ). What are the functions significantly associated with this network? GRN is the central node of this network: which function would you predict for GRN? How well did GeneMANIA perform (hints: use GeneCards (http://www.genecards.org/) , PubMed (http://www.ncbi.nlm.nih.gov/pubmed/))? Locate the gene with the strongest association with GRN. Tip: this gene is the largest node on the network. Re-run an analysis by adding SORT1, HSPG2 to the search. Click on SORT1, click on Add or type the name of the gene in the search box. Do the same for HSPG2. The genes are now added to the search box and a new network is automatically created. Which functions are associated with this new network ? On the left side of the window are located icons that we haven’t yet explored. The first 3 buttons are activating different network layouts. Try the circular , the aligned , and the force_directed layouts. Choose your favorite layout and save the network as an image using the Network image As Shown option from the save menu . EXERCISE 1 ANSWERS: DETAILED EXPLANATION AND SCREENSHOTS EXERCISE 1 - STEPS 1-4 GM1 EXERCISE 1 - STEP 5 GM2 EXERCISE 1 - STEP 6 GM3 Exercise 1 - STEP 7 GM4 Question What are the functions significantly associated with this network? Answer the list of the functions associated with the network are listed in the above screenshot. &quot;lysosomal function&quot;, &quot;vacuolar lumen&quot;, &quot;vacuolar part&quot; are significant under a FDR threshold less than 0.0001. Question GRN is the central node of this network: which function would you predict for GRN? Answer : a function related to lysosome and vacuole Question How well did GeneMANIA perform (hints: use GeneCards (http://www.genecards.org/) , PubMed (http://www.ncbi.nlm.nih.gov/pubmed/))? Answer The top functions predicted by GeneMANIA for GRN were related to lysosome and vacuole. A pubmed search could confirm these results: “We experimentally verified that granulin precursor (GRN) gene, whose mutations cause frontotemporal lobar degeneration, is involved in lysosome function.” (Transcriptional gene network inference from a massive dataset elucidates transcriptome organization and gene function. Belcastro et al. Nucleic Acids Res. 2011 Nov 1;39(20):8677-88. 2011. PMID:21785136) Exercise 1 - STEP 8 Question Locate the gene with the strongest association with GRN (thick edge). Answer is SORT1 Exercise 1 - STEP 9 GM5 GM6 Exercise 1 - STEP 10 (layouts) Circular layout GM7 Aligned layout GM8 Force directed layout GM9 Exercise 1 - STEP 11 (save an image) GM10 Notes about biological interpretation of the results: A paper describing the interaction between GRN and SORT1 and demonstrates how finding related genes could be relevant for elaborating therapy: Targeted manipulation of the sortilin–progranulin axis rescues progranulin haploinsufficiency. Lee et al. Hum Mol Genet. 2014 March 15; 23(6): 1467–1478. Published online 2013 October 26. doi: 10.1093/hmg/ddt534. PMCID:PMC3929086 “Progranulin (GRN) mutations causing haploinsufficiency are a major cause of frontotemporal lobar degeneration (FTLD-TDP). Recent discoveries demonstrating sortilin (SORT1) is a neuronal receptor for PGRN endocytosis and a determinant of plasma PGRN levels portend the development of enhancers targeting the SORT1–PGRN axis. We demonstrate the preclinical efficacy of several approaches through which impairing PGRN's interaction with SORT1 restores extracellular PGRN levels. “ GM11 EXERCISE 2: QUESTIONS AND STEPS TO FOLLOW To start this exercise, you need to download the 30_prostate_cancer_genes.txt file from the course wiki and save it on your computer. For this exercise, you are working with a list of 30 prostate cancer genes. This list can be downloaded after the workshop from the cBioPortal website (http://www.cbioportal.org/) under the download section, user defined list. The cBioPortal for Cancer Genomics stores genomic data from large scale, integrated cancer genomic data sets. During this exercise, you will explore the types of networks that have been used to create the GeneMANIA network from the prostate cancer gene list and you will see how changing input parameters can affect the results. The last step of the exercise consists of uploading a custom network which is a list of genes that are positively correlated with CYP11B1 in mRNA expression data of 94 prostate cancer samples (http://www.cbioportal.org/) . Skills: GeneMANIA search using a gene list; Navigating Search Results; Exploring Networks and advanced options; Uploading a custom network. STEPS Go to GeneMANIA’s homepage at http://www.genemania.org/ In the search window, ensure that the model organism is set to Homo sapiens . Copy and paste genes in the file 30_prostate_cancer_genes.txt. Make sure that the parameter 'Max resultant genes' is set to '20' by clicking on the 3 menu buttons at the right side of the search box and selecting 'Customise advanced options'. Click on the search icon and wait for the results. When your search results load, examine the network. Genes you searched with are indicated with stripes, related genes added by GeneMANIA are represented in black, and colored links represent the interactions that connect the nodes (genes). Move nodes around by selecting them with a mouse to investigate how they are connected. Click any link (edge) connecting two nodes to highlight information about it. Clicking on an edge between 2 nodes will display information about all interaction networks that connect these 2 nodes. It indicates the reference (publication) for these interactions. The colors indicate the type of interaction (co-expression, shared protein domains, co-localization, physical interactions and predicted). Locate and expand the 'Networks' summary tab (on the right ) and look at what data has been used to create the network and predictions. that Co-expression (purple colored lines, weight over 30%) and Shared protein domains (lightgold colored lines, weight over 30%) influence the results the most, but Co-localization (blue colored lines), Physical interactions (salmon colored lines) and Predicted (orange) data are also included. At the top of the Networks summary tab, try Expand “none”, then “top” and “all” to get information about the sources of the different networks. Highlight all connections corresponding to each network by clicking the name of each network category. Click on “Shared protein domains” and see which genes are connected by predicted protein protein interaction. You can do the same for “Co-localization” , “Co-expression” and “Physical interactions”. Tips: these observations of the number of connections make it easier to understand why co-expression and shared protein domains get the higher percent weight on this network: they are helping to connect more genes than physical interactions and predicted; A higher weight means that this network helped more to find related genes. Locate the Functions summary tab (bottom left ) and look at what functions were significantly enriched in this list of prostate genes. “Shared protein domains” is an important part of the network. What would be the GeneMANIA results if we don’t include this source when we run GSEA? Click on ‘Show advanced option ’ which is located at the right of the search box. Uncheck ‘Shared protein domains’ and click on the search icon . Explore the results. Locate the Functions summary tab (bottom left ) and look at what functions were significantly enriched with these new settings. Upload a custom network to GeneMANIA: Go to the menu option at the right of the search box and go to the make sure you see the 'Networks' tab, locate 'Uploaded', expand this option using the down arrow and click on “Upload a network” and browse your computer to locate and select the file CYP11B_pearson_correlation_prostate.txt. Wait about a minute for the network to be uploaded. Click on the search icon to launch the query if necessaryand explore the results and locate the genes linked by the custom network (tip: click on “Uploaded” in the Networks tab). Try additional parameters of the ‘Customise advanced options ’ tab and look at how the changes you made influenced the results. For example change ‘Network weighting’ method or ‘Max resultant genes: ’. EXERCISE 2 ANSWERS: DETAILED STEPS AND SCREENSHOTS Exercise 2 - STEPS 1 to 4 GM12 check that the parameter 'Max resultant genes' is set to '20': Exercise 2 - STEP 5 GM13 Exercise 2 - STEP 6. GM14 Exercise 2 - STEP 7 GM15 GM16 Exercise 2 - STEP 8 GM17 GM18 Exercise 2 - STEP 9 The top pathways with the strongest enrichments are: &quot;cellular hormone metabolic process&quot; with 21 genes in the list overlapping with this pathway. The FDR is equal to 6.75e-36. GM19 Exercise 2 - STEP 10 Question “Shared protein domains” is an important part of the network. What would be the GeneMANIA results if we don’t include this source when we run GSEA? Answer If &quot;shared protein domain&quot; is removed, the relationships between the nodes are from the Co-expression, Co-localization, Predicted and Physical interactions networks.The genes added to the network are different compared to the first network created with &quot;Shared protein domain&quot;. GM20 GM21 Exercise 2 - STEP 11 Question what functions were significantly enriched with these new settings. Answer With the new settings, &quot;hormone biosynthetic process&quot; is the new top enriched pathway. GM22 Exercise 2 - STEP 12 GM23 GM24 GM25 Exercise 2 - STEP 13. GM26 How to get the 30 prostate cancer gene list: GM27 EXERCISE 3: QUESTIONS AND STEPS TO FOLLOW To start this exercise, you need to download the Mixed_gene_list.txt file and save it on your computer. For this exercise, you are working on a gene list created by combining 3 user defined gene lists available from the cBioportal (http://www.cbioportal.org). It contains genes implicated in the DNA damage response, the PI3K-AKT-mTOR signaling pathway and Folate transport. This list is representative of a gene list obtained from transcriptomics data. During this exercise, we will first characterize our gene list based on functions and then we will add potential drug and microRNAs targeting genes in the network, and we will save the report. Skills: GeneMANIA search using a gene list; Navigating Search Results; Exploring Functions; Adding attributes; Create a report. STEPS Go to GeneMANIA’s homepage at http://www.genemania.org/. In the search window, ensure that the model organism is set to Homo sapiens . Copy and paste genes in the file Mixed_gene_list.txt. Click on the search icon and wait for the results. Locate the Functions summary tab (bottom left ) and look at functions returned by GeneMANIA In the functions summary tab, check some functions to color genes included in these functions. To follow this tutorial, you can for example color the “response to insulin” , “DNA recombination” and“vitamin transport” functions. Tip: You need to scroll down to found DNA recombination and vitamin transport as these pathways have an FDR greater than the one for “response to insulin”. We are going next to add miRs and drug interaction networks. Click on ‘Show advanced option ’ which is located at the right of the search box. In the 'Networks' tab, expand 'Attributes' and check “Drug-interactions-2013” and “miRNA-target-predictions-2013”. Check “Physical interactions” and “Co-expression” . Click on “Customise advanced options”. Set “Max resultant genes” to 20 and “Max resultant attributes” to 40. Click on the search icon and wait for the results. Explore the network. Tips: the Drug-interactions and miRNA-target-predictions nodes are displayed in gray. The nodes connected to a drug are genes that are targeted by the drug and nodes connected to a microRNA (miR) are genes predicted to be targeted by this miR. Locate our favorite gene PDPK1 on the network, select it by moving the mouse cursor to its node and wait there for a second. It will highlight this gene and all its connections. Tip: make sure that the black box displaying the details for PDPK1 is closed. Generate and save a report of your results by locating the save menu , and selecting “Report”. The PDF report provides a detailed description of your search and results. Investigate the “history” function by clicking on the related icon located at the bottom of the window. A panel pops up showing the past networks generated by GeneMANIA. Clicking on one panel will relaunch the search for this network. Exercise 3: MORE DETAILS AND SCREENSHOTS Exercise 3 - STEPS 1 - 3 GM28 GM29 Exercise 3 - STEP 4 GM30 Exercise 3 - STEP 5 GM31 Exercise 3 - STEPS 6 GM32 GM33 Exercise 3 - STEP 7 GM34 Exercise 3 - STEP 8 GM35 GM36 Exercise 3 - STEP 9 GM37 -- SOME DEFINITIONS: What are the networks: Definition of the types of interaction: Shared domains: Protein domain data. Two gene products are linked if they have the same protein domain. These data are collected from domain databases, such as InterPro, SMART and Pfam. Co-localization: Genes expressed in the same tissue, or proteins found in the same location. Two genes are linked if they are both expressed in the same tissue or if their gene products are both identified in the same cellular location. Co-expression: Gene expression data. Two genes are linked if their expression levels are similar across conditions in a gene expression study. Most of these data are collected from the Gene Expression Omnibus (GEO); we only collect data associated with a publication. Predicted: Predicted functional relationships between genes, often protein interactions. A major source of predicted data is mapping known functional relationships from another organism via orthology. What is defined by evidence sources?: Evidence sources are the information contained in the multiple databases that GeneMANIA uses to establish interaction between two genes. Network: Node : circle representing the genes Edge: line that links two nodes and represent an interaction between two genes (multiple lines correspond to multiple sources Node size: Mapped to gene score, i.e. the degree to which GeneMANIA predicts the genes are related Thickness of edge: Strength/weight of interaction Layout : The layout is different each time so the user can request the layout run multiple times until the user is satisfied with the result. in Networks tab: Percent weight (score) : a higher weight means that this network helped more to find related genes. in Functions tab : FDR : False discovery rate (FDR) is greater than or equal to the probability that this is a false positive. Coverage : (number of genes in the network with a given function) / (all genes in the genome with the function) In advanced options: Network weighting? GeneMANIA can use a few different methods to weight networks when combining all networks to form the final composite network that results from a search. The default settings are usually appropriate, but you can choose a weighting method in the advanced option panel. (more details at http://pages.genemania.org/help/). Related genes : are genes added by GeneMANIA in addition to the genes from the query. It helps to grow the network and then to predict function of the query gene(s). The attributes represent the differences sources of evidence that can be used to build the network. Notes : prostate cancer gene list is “AKR1C3 AR CYB5A CYP11A1 CYP11B1 CYP11B2 CYP17A1 CYP19A1 CYP21A2 HSD17B1 HSD17B10 HSD17B11 HSD17B12 HSD17B13 HSD17B14 HSD17B2 HSD17B3 HSD17B4 HSD17B6 HSD17B7 HSD17B8 HSD3B1 HSD3B2 HSD3B7 RDH5 SHBG SRD5A1 SRD5A3 STAR”. mixed gene list is AKT1 AKT1S1 AKT2 ATM ATR BRCA1 BRCA2 CHEK1 CHEK2 FANCF FOLR1 FOLR2 FOLR3 FOXO1 FOXO3 MDC1 MLH1 MLST8 MSH2 MTOR PARP1 PDPK1 PIK3CA PIK3R1 PIK3R2 PTEN RAD51 RHEB RICTOR RPTOR SLC19A1 TSC1 TSC2 Tip: look at GeneMANIA help pages when you run an analysis on your own after the workshop: http://pages.genemania.org/help/. "],
["integrated-assignment.html", "Integrated Assignment Goal DATASET 1 Background Data processing PART 1: run g:Profiler PART 2: save as Generic Enrichment Map output (BE) PART 3: save as Generic Enrichment Map output (NE) PART 4: create an enrichment map PART 5: GSEA (run and create an enrichment map) PART 6: iRegulon DATASET 2 PART 1: ReactomeFI PART 2: GeneMANIA", " Integrated Assignment Veronique Voisin This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License. This means that you are able to copy, share and modify the work, as long as the result is distributed under the same license. Goal Familiarize yourself with g:Profiler, GSEA , EnrichmentMap using the Esophageal adenocarcinoma gene expression data (DATASET 1). Familiarize yourself with ReactomeFI and GeneMANIA using mutation data (DATASET 2). Network layouts are flexible and can be rearranged. What you see when you perform these exercises may not be identical to what you see in the tutorial, or what you have seen other times that you have performed the exercises. Exact layouts and predictions can also be affected by updates to the networks database that the tools are using. However it is expected that the network weights and predicted genes will be similar to those shown here. DATASET 1 Background Gene expression data from Esophageal adenocarcinoma (EAC) is used for this first part of the integrated assignment. Esophageal adenocarcinoma (EAC) has a rising incidence and a 5-year survival of only 15%. The single major risk factor for development of EAC is chronic heartburn, which eventually leads to a change in the lining of the esophagus called Barrett’s Esophagus (BE). Specimens were collected from patients with normal esophagus (NE) and Barrett’s esophagus (BE). RNA was extracted from these samples and expression profiling was assessed using Affymetrix HG-U133A microarray PMID:24714516. Differentially expressed genes between BE and NE were determined. Data processing The Affymetrix data are stored in the Gene Expression Omnibus (GEO) repository under the accession number GSE39491 PMID:24714516. The RMA (Robust Multichip Average) normalized data were downloaded from GEO and further processed using the Bioconductor package limma to estimate differential expression between the groups. The results of the limma t-tests were corrected for multiple hypothesis testing using the Benjamini-HochBerg method (FDR). For g:Profiler, genes with a FDR equal or less than 0.0001 and a logFC of 2 were retrieved and stored in a text file. For GSEA, a rank file has been created by ranking the genes from the highest t statistics value (up-regulated in BE compared to NE) to the lowest t values (down-regulated in BE compared to NE). The code used to process the data is available from the course page. Please feel free to adapt it and use it with your own data. PART 1: run g:Profiler Open g:Profiler In Options, make sure All results is not checked (this keeps significant results only), and select GO molecular function, No electronic GO annotations, and Reactome. Set Benjamini-Hochberg in the 'Significance threshold' box. 'Set minimum size of functional category to 3 and maximum to 500. Set 2 for the Size of query/ term intersection.': These options are not available in the current version of g:Profiler. They might be available again in the next release.. Run analysis of the genes differentially altered between BE and normal: copy and paste the gene list into the g:Profiler input window BEonly_genelist.txt. Question: What is the most significant GO:term? What is the p-value for this GO:term? Question: Is this p-value already corrected for multiple hypothesis testing? What type of correction is used for your current analysis? PART 2: save as Generic Enrichment Map output (BE) Now we have to generate an output from the enrichment analysis and save it in appropriate format for EnrichmentMap. Scroll down, select the tab for Detailed results, and export the data in Generic EnrichmentMap (GEM) format and save it on your computer. We will need this file to create an enrichment map. PART 3: save as Generic Enrichment Map output (NE) Generate and save the Generic EnrichmentMap for genes in NConly_genelist.txt (i.e., delete the old gene list and copy/paste the new gene list in the box). It contains the genes specific of the normal tissue samples. Run g:Profiler with this list using same options as in PART 1 and again save the output as a Generic Enrichment Map (GEM) format. We will need this file for EnrichmentMap. PART 4: create an enrichment map Create an enrichment map to visualize the outputs from g:Profiler. Let's create an EnrichmentMap for the pathways that were enriched by the genes specific of the BE samples and one for the genes specific of the NE samples. Make sure to rename your g:Profiler results so you know which one is BE and which one is NE. Open Cytoscape Go: Apps and click on EnrichmentMap. A 'Create Enrichment Map' dialog box appears. Drag and Drop the 2 g:Profiler result files in the 'Data Sets:' window. It populated automatically two data sets on for the BE results and one for the NE results. Make sure that for the 2 datasets the 'Analysis Type' is set to 'Generic/gProfiler' and that the g:Profiler result file has been correctly uploaded in the 'Enrichments' field. As 'Network Name', uncheck 'Use Default' and write &quot;BEvsNE&quot; or the name of your choice for this network. Set the 'FDR q-value cutoff' to 0.05. 'Build' the map. If successful, you will see a network where each node represents a pathway and edges connect pathways with shared genes. Blue edges connect nodes from dataset1 (BE in my case) and Green edges connect nodes from dataset2 (NE in my case). In Control Panel and in the 'EnrichmentMap' tab, go to 'Style' (near the bottom) and change the 'Chart Data:' to 'Color by Data Set'. Now the nodes are colored in blue for dataset1 and in green for dataset2. Annotate the network using the AutoAnnotate Apps. Try different layouts if you'd like. Zoom in and move nodes around to be able to read the labels. Select a node of your choice. When the node is highlighted, the 'EM Heat Map' in 'Table Panel' will display the genes in this pathway that are overlapping with your input gene list. A gray square means that the gene is absent in the dataset. Note: you also could create and upload an expression file when you build the enrichment map, and the expression values for each gene in the pathways will be displayed here in the 'EM Heat Map'. Click on any edge (the line between nodes). In the 'Table panel' ('EM Heat Map') you should see a heatmap of all genes both gene-sets connected by this edge have in common. Select several nodes and edges. EM Heat map will show the union of all genes (Genes: All) or genes in common (Genes:Common) in the selected gene sets. In Control Panel, go to the EnrichmentMap tab. Change Q-value as well as Edge (Similarity) cutoffs and see how the network changes. Redo the layout. Save the file. Question What conclusions can you make based on these networks? PART 5: GSEA (run and create an enrichment map) Launch GSEA. Run GSEA using the rank file that has been created from the differential expression test comparing BE vs NE BEvsNE_ranks.rnk and the pathway file Human_GOBP_AllPathways_no_GO_iea_May_24_2016_symbol.gmt. open GSEA and first import the files using the &quot;Load data&quot; window: upload the .rnk and .gmt files (the gmt file can be found by clicking the three dots next to 'Gene sets database' and clicking on 'Gene matrix (local gmx/gmt) ). Go the 'Run GSEAPreranked' window and select the correct gmt file and the rank file Use 100 permutations for the lab exercise. For time reasons - Use 100 permutations for the lab exercise but use 1000 for your own data analysis. Choose a name for your analysis, a destination folder and run GSEA. Create an enrichment map: Open Cytoscape and the EnrichmentMap app. The enrichment results are 2 excel files called gsea_report_for_na_neg and gsea_report_for_na_pos within the GSEA folder saved on your computer but you should be able to drag and drop the whole GSEA folder and that will populate the required fields automatically. use an FDR q-value cutoff of 0.01. Upload the expression file BE_vs_NE_expression.txt(right click, save link as). Examine the results as you did for the g:Profiler map (e.g move nodes around, use the slide bar to adjust q value to 0.01 and redo the layout, separate blue and red nodes). Save the file. Save an image. Keep your session open for Part 8. Optional: Autoannotate your map (see below screenshot for results) Note: you may get slightly different results as 100 permutations is not enough to get reliable results. It is better to use 1000 permuatations. PART 6: iRegulon Export extracellular matrix genes. Using your GSEA map at q-value 0.01, select all nodes from the extracellular matrix/collagen cluster (after autoannotating). Go to Table Panel, and click on the Settings icon (located on the right, shaped like a ship wheel) and click on 'Export as TXT'. Save the text file under the name 'extracellularmatrix_cluster_genes.txt' or use this file extracellularmatrix_cluster_genes.txt. Import the extracellular matrix genes as a network. In Cytoscape, go to the menu bar and select, File, Import, Network from File... Browse your computer and select the 'extracellularmatrix_cluster_genes.txt' file and click on open. An 'Import Network From Table' window opens and in the table preview, make sure that the 'Gene' column is the source node (green dot). Click on 'OK'. A 'Confirmation' dialog box saying that 'No edges will be created in the network' opens. Click on 'Yes'. Select nodes and run iRegulon. If successful, you should see a grid of gray nodes. If you are zoomed out, they might be very faint. Zoom in until you see them, then zoom out until you see all the nodes and select them all using the mouse. Go the Cytoscape menu and select 'Apps', 'iRegulon', 'Predict regulators and targets'. Click on 'Submit'. Observe the iRegulon results in the Results Panel. Add the first 2 hits (TCF12 and BATF) to the network. Go to the &quot;Transcription Factors' tab and click on the first hit (TCF12) to select it. Add it to the network using the green '+' button . Execute the same steps for the second hit (BATF). If successful, you should see targets of TCF12 and BATF linked to these 2 genes by edges (lines). Create a subnetwork with all nodes connected to TCF12 and BATF. using the mouse select TCF12 and all edges around this node and pressing the shift key, select also BATF and all the edges around this node. All selected edges should now be highlighted in red and the 2 transcription factors in yellow. In the Cytoscape menu bar, go to Select, Nodes, Nodes connected by selected edges. More nodes should be selected now and the edges still highlighted in red. Select the subnetwork icon ('New Network from Selection (all edges)')from the Cytoscape toolbar. If successful, you should have created a subnetwork containing only the targeted genes and the two transcription factors. Arrange the network such that we can distinguish genes linked to TCF12 only , linked to BATF only or linked to both transcription factors. go to the Cytoscape menu, Layout, Circular Layout, all Nodes. Feel free to use your own strategy. Optional. Import the .rnk file that we use for GSEA BEvsNE_ranks.rnk as attribute and color the nodes accordingly to the score values. in the menu bar, select, File, Import, Table from File..., select the rank file and click on 'Open'. A dialog box ('Import Columns From Table') opens. Click on 'Advanced options' and uncheck 'Use first line as column names' and click 'OK'. Rename Column2 as 'myscore'. Click 'OK'. in Control Panel, go to Style and in the Node tab, expand the 'Fill Color' tab. Retrieve and select the 'myscore' column in the 'column' fied. Make sure that the 'Mapping type' is set to 'Continuous Mapping'. The score should ranged from -13.16 to 13.16. Adjust the color if necessary. Screenshot of resulting network: DATASET 2 Stomach cancer or gastric cancer is a cancer developing from the lining of the stomach. The most common cause is infection by the bacteria Helicopter pylori, which accounts for more than 60% of cases. Certain types of 'H. pylori' have greater risks than others. Other common causes include eating pickled vegetables and smoking. MutSig - is a mutation signal processing tool created by the Broad Institute. It estimates the significance of the gene mutation rate based on abundances of the mutations, clustering of the mutations in hotspots and conservation of the mutated positions. The gene list for this assignment is the output from MutSig run based on Stomach Adenocarcinoma somatic mutations found in ~300 samples. It is publicly available through TCGA portal. File provided: STAD_MutSig.txt Goal: familiarize yourself with ReactomeFI and GeneMANIA. PART 1: ReactomeFI Create a network using ReactomeFI. Open Cytoscape. Choose App -&gt; Reactome FI -&gt; Gene set/mutation analysis Upload STAD_MutSig.txt and built a network without linkers: The network may look slightly different compared to below screenshot if the underlying database has been updated since the screenshot was taken upload your file or copy and paste the gene names in the gene set field. Fetch FI annotation (Hint: right click on a blank space, Reactome FI, Fetch FI Annotations). You should see arrows (directed graph). Run Pathway enrichment (Hint: right click on the network panel and select Reactome FI &gt; Analyze network functions &gt; Pathway enrichment). Question What is the pathway with the lowest (best) FDR? Do a subnetwork of ErbB signaling pathway (K). select the pathway in the table, that should highlight the genes in yellow. Use the subnetwork icon on the Cytoscape tool bar to create it (&quot;New network from selection&quot;). Go back to the full network (in the Control panel on the left, click the highest level of 'STAD_MutSig'). Cluster the network and perform pathway enrichment on the network. Questions How many clusters did the analysis retrieve? What is the FDR value of the most significant pathway of module 0 PART 2: GeneMANIA Use the same mutation data STAD_MutSig.txt to create a network using GeneMANIA in order to visualize which genes are known to physically interact with each other. Install the latest version of the Cytoscape GeneMANIA app (Version 3.5.0) * Go the Cytoscape menu bar and select Apps, App Manager... . In the App Manager dialog box, go to the 'Check for Updates' tab and update GeneMANIA if necessary. Note: if the 'Check for Updates' tab is blank, it means that you have installed the most recent versions of all apps. Create the network In Cytoscape, go to Control Panel and locate and select the Network Tab in the Control Panel Make sure the GeneMANIA search provider is selected in the Network Search Bar. Choose Homo sapiens from the list of supported organisms Copy and paste the gene list STAD_MutSig.txt in the field. Locate the &quot;More Options...&quot; button at the right side of the field and only select 'Physical interactions' as 'Interaction Networks' and set 0 to the 'Max Resultant Genes'. Click the &quot;Search Network&quot; button The network may look slightly different compared to below screenshot if the underlying database has been updated since the screenshot was taken. Screenshot of the output: the screenshot only includes nodes connected to other nodes. Singletons are not part of the screenshot. Explore the functions in the GeneMANIA Results Panel. Go to 'Results Panel' located at the right side and select the GeneMANIA tab. Choose the 'Functions' tab to visualize the list of enriched GO gene-sets. Question Can you see which genes are included in these gene-sets? Hint: you can click on a function of your choice to see corresponding nodes highlighted in yellow. Improve the visual style: Color nodes by function. In Control Panel, select the 'Style' tab and go to the 'Node' panel. Expand the 'Fill Color' field using the down arrow and set 'Column' to 'annotation name' which is the top field (/! not 'annotations'). Select one annotation of your choice by clicking on the white space and choose a color. Repeat for 2 more annotation names. For the current example, we have selected the top 3 enriched GO annotations 'gamma-catenin binding', 'regulation of protein serine/threonine kinase activity' and 'adherens junction organization'. Hint: the annotation names are displayed in alphabetical order. Edge width (optional). In Control Panel, go to the 'Edge' panel. Expand the 'Width' field using the down arrow. A grah is displayed. Double click on the graph to select it and move the left and right handles up. Look at the changes on the network (suggested values are approximately 7 for the left handle and approximately 18 for the right handle). Click on OK. Create a subnetwork containing CTNNB1 and connected genes Locate CTNNB1, use the &quot;First neighbors of selected nodes&quot; icon (has the shape of 2 houses) in the toolbar to highlight genes connected to CTNNB1 Create a subnetwork using the approriate icon. How many nodes do contain this subnetwork? Hint: Go to Control Panel, Network and look at the number of nodes corresponding to your subnetwork. Note: on the above the screenshot, the CCBN1 color of the edges were changed by bypassing the style (select the edges, right click, edit, ByPass Style, Set Bypass to Selected Edges , change color in Byp. column) Optional part 1: Launch a GeneMANIA search using the &quot;Local Search&quot; option (for big networks) In Cytoscape , open the GeneMANIA app and select 'GeneMANIA Local Search'. Copy and paste the MutSig genes in the 'Genes of Interest' field. In Advanced Options, select only 'Physical interactions' as 'Interaction Networks' and set 0 in the &quot;Find the top&quot; 0 &quot;related genes&quot;. Click on 'Start'. If you use it for the first time and you haven't installed data as it was said in the installation instructions, only install &quot;CORE&quot; data as the full data may take 1 hour to download. There are 2 ways to perform a GeneMANIA search. The first option using the Network search bar from the Control Panel is doing a seach by calling and connecting the GeneMANIA server (same as the website:https://genemania.org/). The other option as just showed here is to select GeneMANIA from the Apps menu and click on 'Local Search...'. This option will use a database that is installed locally on your computer when you first use GeneMANIA. As it does not imply any connection to the server, this option is the best choice for large query, e.g input gene list size greater than 100 or resulting network containing more than 200 nodes. The network and predicted functions should be the same as the ones obtained in part 2. Feel free to explore the network or follow the same steps as part 2. Optional part 2: Use STRING from the Network Search Bar STRING (Search Tool for the Retrieval of Interacting Genes/Proteins) is a biological database and web resource of known and predicted protein–protein interactions. * In Cytoscape, go to Control Panel and locate and select the Network Tab in the Control Panel * Make sure 'STRING protein query' is selected in the Network Search Bar. * Type CTNNB1 in the search field. * Click the &quot;Search Network&quot; button * Explore the network! Congratulations! You have reached the end of the integrated assignment. "],
["integrated-assignment-solutions.html", "Integrated Assignment Solutions g:Profiler REACTOME FI GeneMANIA", " Integrated Assignment Solutions This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License. This means that you are able to copy, share and modify the work, as long as the result is distributed under the same license. By Veronique Voisin The results are stored in this folder. g:Profiler Question: What is the most significant GO:term? What is the p-value for this GO:term Answer: extracellular matrix organization Question: Is this p-value already corrected for multiple testing? What type of correction is used for your current analysis? Answer: yes, it is already corrected for multiple hypothesis testing. I set the Significance threshold box to &quot;Benjaminin-Hochberg FDR&quot;. Re-run the analysis with User p-value threshold set to 0.0001. Question: What has been changed? Answer: Only the gene-set with adjusted pvalue equal or less than 0.0001 are displayed. The list is reduced compared to the results obtained with the default settings. Ordered query: Question: Do you seen any changes in the output in comparison to the analysis of the unordered gene list (PART 2) Answer Although some terms are similar, their pvalues changed as well as the number of term genes used to calculate the pvalue. Question What can you conclude about these networks? Answer The pathways are relevant to the biological model under study. The changes are related to the transformation of the epithelial cells into mesenchymal ones. REACTOME FI Pathway enrichment on the whole network. Question What is the pathway with the lowest (best) FDR? Answer The pathway with the lowest FDR is Endometrial cancer (K) with an FDR equal to 5.78w-16. Cluster the network and perform pathway enrichment on the network. Question How many clusters did the analysis retrieve? Answer The analysis retrieved 10 clusters named module 0 to module 9. Question What is the FDR value of the most significant pathway of module 0? Answer RAF/MAP kinase cascade (first row) GeneMANIA Question What is the number of nodes in the CTNBB1 network. Answer There are 22 nodes. "]
]
